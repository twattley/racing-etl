2024-06-07T05:37:22Z | INFO - Running historical pipeline
2024-06-07T05:37:24Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:37:24Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:37:24Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:37:24Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:37:25Z | INFO - Scrape_links.py execution started.
2024-06-07T05:37:25Z | INFO - Fetching data with query: SELECT * FROM rp_raw.missing_dates
2024-06-07T05:37:25Z | INFO - Scrape_links.py execution started.
2024-06-07T05:37:25Z | INFO - Fetching data with query: SELECT * FROM tf_raw.missing_dates
2024-06-07T05:37:26Z | INFO - Generated URL for scraping: https://www.racingpost.com/results/2024-06-04
2024-06-07T05:37:26Z | INFO - Generated URL for scraping: https://www.timeform.com/horse-racing/results/2024-06-04
2024-06-07T05:37:33Z | INFO - Page load complete. Proceeding to scrape links.
2024-06-07T05:37:34Z | INFO - Found 36 valid links for date 2024-06-04.
2024-06-07T05:37:34Z | INFO - Inserting 36 links into the database.
2024-06-07T05:37:34Z | INFO - Storing 36 records in rp_raw.days_results_links
2024-06-07T05:37:34Z | INFO - Scrape_links.py execution completed.
2024-06-07T05:37:37Z | INFO - Page load complete. Proceeding to scrape links.
2024-06-07T05:38:07Z | INFO - Found 122 valid links for date 2024-06-04.
2024-06-07T05:38:07Z | INFO - Inserting 122 links into the database.
2024-06-07T05:38:07Z | INFO - Storing 122 records in tf_raw.days_results_links
2024-06-07T05:38:08Z | INFO - Scrape_links.py execution completed.
2024-06-07T05:38:10Z | INFO - RP results data scraping started.
2024-06-07T05:38:10Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:38:10Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:38:10Z | INFO - TF results data scraping started.
2024-06-07T05:38:10Z | INFO - Creating a new headless WebDriver for Timeform: True
2024-06-07T05:38:10Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:38:11Z | INFO - Fetching data with query: SELECT * FROM rp_raw.missing_links
2024-06-07T05:38:11Z | INFO - Logging in to Timeform
2024-06-07T05:38:16Z | INFO - Number of missing links: 28
2024-06-07T05:38:16Z | INFO - Scraping link: https://www.racingpost.com/results/30/leicester/2024-06-04/867954
2024-06-07T05:38:21Z | INFO - Scraping link: https://www.racingpost.com/results/30/leicester/2024-06-04/867955
2024-06-07T05:38:23Z | INFO - Scraping link: https://www.racingpost.com/results/30/leicester/2024-06-04/867956
2024-06-07T05:38:27Z | INFO - Scraping link: https://www.racingpost.com/results/30/leicester/2024-06-04/867957
2024-06-07T05:38:30Z | INFO - Scraping link: https://www.racingpost.com/results/30/leicester/2024-06-04/867958
2024-06-07T05:38:34Z | INFO - Scraping link: https://www.racingpost.com/results/30/leicester/2024-06-04/867959
2024-06-07T05:38:37Z | INFO - Log in to Timeform success
2024-06-07T05:38:37Z | INFO - Fetching data with query: SELECT * FROM tf_raw.missing_links
2024-06-07T05:38:39Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-04/868216
2024-06-07T05:38:42Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-04/868217
2024-06-07T05:38:45Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-04/868218
2024-06-07T05:38:48Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-04/868219
2024-06-07T05:38:49Z | INFO - Number of missing links: 28
2024-06-07T05:38:49Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-04/1433/29/1
2024-06-07T05:38:52Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-04/868220
2024-06-07T05:38:56Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-04/868221
2024-06-07T05:39:00Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/868222
2024-06-07T05:39:03Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-04/1503/29/2
2024-06-07T05:39:04Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/868223
2024-06-07T05:39:07Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/868224
2024-06-07T05:39:11Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/868225
2024-06-07T05:39:14Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-04/1533/29/3
2024-06-07T05:39:15Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/868226
2024-06-07T05:39:20Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/868227
2024-06-07T05:39:23Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-04/1603/29/4
2024-06-07T05:39:23Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/870053
2024-06-07T05:39:27Z | INFO - Scraping link: https://www.racingpost.com/results/513/wolverhampton-aw/2024-06-04/870054
2024-06-07T05:39:27Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-04/1638/29/5
2024-06-07T05:39:31Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867843
2024-06-07T05:39:32Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-04/1708/29/6
2024-06-07T05:39:34Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867844
2024-06-07T05:39:37Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-04/1815/30/1
2024-06-07T05:39:38Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867845
2024-06-07T05:39:41Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867846
2024-06-07T05:39:44Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-04/1845/30/2
2024-06-07T05:39:46Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867847
2024-06-07T05:39:50Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867848
2024-06-07T05:39:52Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-04/1915/30/3
2024-06-07T05:39:53Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/867849
2024-06-07T05:39:56Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-04/1945/30/4
2024-06-07T05:39:57Z | INFO - Scraping link: https://www.racingpost.com/results/61/southwell/2024-06-04/870052
2024-06-07T05:40:00Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-04/2015/30/5
2024-06-07T05:40:01Z | INFO - Converting data...
2024-06-07T05:40:01Z | INFO - Data converted successfully
2024-06-07T05:40:01Z | INFO - Sorting data...
2024-06-07T05:40:01Z | INFO - Data Columns Index(['race_timestamp', 'race_date', 'course_name', 'race_class',
       'horse_name', 'horse_type', 'horse_age', 'headgear', 'conditions',
       'horse_price', 'race_title', 'distance', 'distance_full', 'going',
       'number_of_runners', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'official_rating', 'horse_weight', 'draw', 'country',
       'surface', 'finishing_position', 'total_distance_beaten', 'ts_value',
       'rpr_value', 'extra_weight', 'comment', 'race_time', 'currency',
       'course', 'jockey_name', 'jockey_claim', 'trainer_name', 'sire_name',
       'dam_name', 'dams_sire', 'owner_name', 'horse_id', 'trainer_id',
       'jockey_id', 'sire_id', 'dam_id', 'dams_sire_id', 'owner_id', 'race_id',
       'course_id', 'meeting_id', 'unique_id', 'debug_link', 'created_at'],
      dtype='object')
2024-06-07T05:40:01Z | INFO - Data Sample        race_timestamp  ...          created_at
0 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
1 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
2 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
3 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
4 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
5 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
6 2024-06-04 16:38:00  ... 2024-06-07 05:38:18
0 2024-06-04 16:03:00  ... 2024-06-07 05:38:21
1 2024-06-04 16:03:00  ... 2024-06-07 05:38:21
2 2024-06-04 16:03:00  ... 2024-06-07 05:38:21

[10 rows x 52 columns]
2024-06-07T05:40:01Z | INFO - Data Sample        race_timestamp  ...          created_at
8 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
7 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
6 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
5 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
4 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
3 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
2 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
1 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
0 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
5 2024-06-04 15:15:00  ... 2024-06-07 05:39:54

[10 rows x 52 columns]
2024-06-07T05:40:01Z | INFO - Validating data...
2024-06-07T05:40:01Z | INFO - Data validated successfully
2024-06-07T05:40:01Z | INFO - Sorting data...
2024-06-07T05:40:01Z | INFO - Data Columns Index(['race_timestamp', 'race_date', 'course_name', 'race_class',
       'horse_name', 'horse_type', 'horse_age', 'headgear', 'conditions',
       'horse_price', 'race_title', 'distance', 'distance_full', 'going',
       'number_of_runners', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'official_rating', 'horse_weight', 'draw', 'country',
       'surface', 'finishing_position', 'total_distance_beaten', 'ts_value',
       'rpr_value', 'extra_weight', 'comment', 'race_time', 'currency',
       'course', 'jockey_name', 'jockey_claim', 'trainer_name', 'sire_name',
       'dam_name', 'dams_sire', 'owner_name', 'horse_id', 'trainer_id',
       'jockey_id', 'sire_id', 'dam_id', 'dams_sire_id', 'owner_id', 'race_id',
       'course_id', 'meeting_id', 'unique_id', 'debug_link', 'created_at'],
      dtype='object')
2024-06-07T05:40:01Z | INFO - Data Sample        race_timestamp  ...          created_at
8 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
7 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
6 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
5 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
4 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
3 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
2 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
1 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
0 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
5 2024-06-04 15:15:00  ... 2024-06-07 05:39:54

[10 rows x 52 columns]
2024-06-07T05:40:01Z | INFO - Data Sample        race_timestamp  ...          created_at
8 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
6 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
5 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
4 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
3 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
2 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
1 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
0 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
7 2024-06-04 15:45:00  ... 2024-06-07 05:39:58
2 2024-06-04 15:15:00  ... 2024-06-07 05:39:54

[10 rows x 52 columns]
2024-06-07T05:40:01Z | INFO - Storing 271 records in rp_raw.performance_data
2024-06-07T05:40:01Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_rp_data'
2024-06-07T05:40:01Z | INFO - Query executed. Number of rows affected: 1
2024-06-07T05:40:07Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-04/2045/30/6
2024-06-07T05:40:17Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1415/47/1
2024-06-07T05:40:23Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1445/47/2
2024-06-07T05:40:27Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1515/47/3
2024-06-07T05:40:34Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1545/47/4
2024-06-07T05:40:38Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1620/47/5
2024-06-07T05:40:44Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1650/47/6
2024-06-07T05:40:56Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1720/47/7
2024-06-07T05:41:00Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/southwell/2024-06-04/1750/47/8
2024-06-07T05:41:08Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/1730/58/1
2024-06-07T05:41:16Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/1800/58/2
2024-06-07T05:41:24Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/1830/58/3
2024-06-07T05:41:29Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/1900/58/4
2024-06-07T05:41:34Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/1930/58/5
2024-06-07T05:41:41Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/2000/58/6
2024-06-07T05:41:46Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/2030/58/7
2024-06-07T05:41:52Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/wolverhampton/2024-06-04/2100/58/8
2024-06-07T05:41:57Z | INFO - Converting data...
2024-06-07T05:41:57Z | INFO - Data converted successfully
2024-06-07T05:41:57Z | INFO - Sorting data...
2024-06-07T05:41:57Z | INFO - Data Columns Index(['tf_rating', 'tf_speed_figure', 'draw', 'finishing_position',
       'horse_name', 'horse_id', 'horse_name_link', 'sire_name', 'dam_name',
       'sire_id', 'dam_id', 'trainer_name', 'trainer_id', 'jockey_name',
       'jockey_id', 'horse_age', 'equipment', 'official_rating',
       'fractional_price', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'course', 'race_date', 'race_time',
       'race_timestamp', 'course_id', 'race', 'race_id', 'distance', 'going',
       'prize', 'hcap_range', 'age_range', 'race_type', 'main_race_comment',
       'debug_link', 'created_at', 'unique_id'],
      dtype='object')
2024-06-07T05:41:57Z | INFO - Data Sample   tf_rating  ...                                          unique_id
0       79+  ...  2d5535780e15d47ae0536f479881faaf641cc84eb7db7a...
1       77+  ...  2210374cfbf7ccbfa6ad123927d7070d79776496c01aa8...
2       76+  ...  e4d52fc99fba919eaca4b6739bdd59b8d3c4201719cf02...
3       72+  ...  ddb93eda6d2e7b39010b5cd97dac4cc93290312a00f0bb...
4       61+  ...  2a17874ceb80c5c6f86bfd1f869b13cdf97b20750ee9ed...
5        41  ...  f8c17541a02e40b30bac87866c405c741dd7767d1b8a5a...
6        39  ...  35502114a44cbd5f5d0befcaef078673e925583370c1d7...
7        39  ...  702979b77ffccf5ffdc24bf0d2a5d1600b6724a97e6153...
8        33  ...  ce61041496ed0076a0425a2c6b37e87e581b00d4a8bf34...
9        20  ...  ebc0a9cf5056b637c3aa79280980092aad959be7d36a39...

[10 rows x 40 columns]
2024-06-07T05:41:57Z | INFO - Data Sample   tf_rating  ...                                          unique_id
8       t44  ...  f89e83e87c7a556c7222edb9c644cdb9508ff799631786...
7       t61  ...  abff9146f8fda85abf45f8107363231077a35184ac94d6...
6       t56  ...  b334fccfe376284a7df5e3d413cee791fab230ca966fcb...
5       t67  ...  76b78a0d044074d71b735af5365736f4ba5dd448abb079...
4       t66  ...  e81bdb282228c3a85433aa20cbb5083aae28f0a12c65e5...
3       t69  ...  7f447536cb51cd5c0ae05c40faf2cba5d33bc890cc13f4...
2       t72  ...  492bf83eed56a866e15919ffef597c43da486334e6dfc0...
1      t66+  ...  903ae00063bdda9c2f14a3fc29235abdb7b7b633f0ab52...
0       t75  ...  8c5a553e80e749ba530632be6bb9ad7a5d79534909e70a...
9        t7  ...  3cde5d8dddfa5e33b3a8b3120fc54bdfb30595be5547fe...

[10 rows x 40 columns]
2024-06-07T05:41:57Z | INFO - Validating data...
2024-06-07T05:41:57Z | INFO - Data validated successfully
2024-06-07T05:41:57Z | INFO - Sorting data...
2024-06-07T05:41:57Z | INFO - Data Columns Index(['tf_rating', 'tf_speed_figure', 'draw', 'trainer_name', 'trainer_id',
       'jockey_name', 'jockey_id', 'sire_name', 'sire_id', 'dam_name',
       'dam_id', 'finishing_position', 'horse_name', 'horse_id',
       'horse_name_link', 'horse_age', 'equipment', 'official_rating',
       'fractional_price', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'course', 'race_date', 'race_time',
       'race_timestamp', 'course_id', 'race', 'race_id', 'distance', 'going',
       'prize', 'hcap_range', 'age_range', 'race_type', 'main_race_comment',
       'debug_link', 'created_at', 'unique_id'],
      dtype='object')
2024-06-07T05:41:57Z | INFO - Data Sample   tf_rating  ...                                          unique_id
8       t44  ...  f89e83e87c7a556c7222edb9c644cdb9508ff799631786...
7       t61  ...  abff9146f8fda85abf45f8107363231077a35184ac94d6...
6       t56  ...  b334fccfe376284a7df5e3d413cee791fab230ca966fcb...
5       t67  ...  76b78a0d044074d71b735af5365736f4ba5dd448abb079...
4       t66  ...  e81bdb282228c3a85433aa20cbb5083aae28f0a12c65e5...
3       t69  ...  7f447536cb51cd5c0ae05c40faf2cba5d33bc890cc13f4...
2       t72  ...  492bf83eed56a866e15919ffef597c43da486334e6dfc0...
1      t66+  ...  903ae00063bdda9c2f14a3fc29235abdb7b7b633f0ab52...
0       t75  ...  8c5a553e80e749ba530632be6bb9ad7a5d79534909e70a...
9        t7  ...  3cde5d8dddfa5e33b3a8b3120fc54bdfb30595be5547fe...

[10 rows x 40 columns]
2024-06-07T05:41:57Z | INFO - Data Sample   tf_rating  ...                                          unique_id
8       t44  ...  f89e83e87c7a556c7222edb9c644cdb9508ff799631786...
7       t61  ...  abff9146f8fda85abf45f8107363231077a35184ac94d6...
6       t56  ...  b334fccfe376284a7df5e3d413cee791fab230ca966fcb...
5       t67  ...  76b78a0d044074d71b735af5365736f4ba5dd448abb079...
4       t66  ...  e81bdb282228c3a85433aa20cbb5083aae28f0a12c65e5...
3       t69  ...  7f447536cb51cd5c0ae05c40faf2cba5d33bc890cc13f4...
2       t72  ...  492bf83eed56a866e15919ffef597c43da486334e6dfc0...
1      t66+  ...  903ae00063bdda9c2f14a3fc29235abdb7b7b633f0ab52...
0       t75  ...  8c5a553e80e749ba530632be6bb9ad7a5d79534909e70a...
9        t7  ...  3cde5d8dddfa5e33b3a8b3120fc54bdfb30595be5547fe...

[10 rows x 40 columns]
2024-06-07T05:41:57Z | INFO - Storing 271 records in tf_raw.performance_data
2024-06-07T05:41:58Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_tf_data'
2024-06-07T05:41:58Z | INFO - Query executed. Number of rows affected: 1
2024-06-07T05:41:59Z | INFO - Checking for missing data...
2024-06-07T05:41:59Z | INFO - Fetching data with query: SELECT * FROM rp_raw.missing_links;
2024-06-07T05:41:59Z | INFO - Fetching data with query: SELECT * FROM tf_raw.missing_links;
2024-06-07T05:42:06Z | INFO - All RP data scraped successfully
2024-06-07T05:42:06Z | INFO - Running todays pipeline
2024-06-07T05:42:08Z | INFO - Todays RP results data scraping started.
2024-06-07T05:42:08Z | INFO - Todays TF results data scraping started.
2024-06-07T05:42:08Z | INFO - Fetching data with query: 
        SELECT * FROM public.course cr
        left join public.country ct on 
        cr.country_id::text = ct.country_id::text
        
2024-06-07T05:42:08Z | INFO - Fetching data with query: 
        SELECT * FROM public.course cr
        left join public.country ct on 
        cr.country_id::text = ct.country_id::text
        
2024-06-07T05:42:08Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:42:08Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:42:08Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:42:08Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:42:11Z | INFO - Clicked on button for date: 2024-06-07
2024-06-07T05:42:16Z | INFO - Toggling settings button
2024-06-07T05:42:22Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/1745/4/1/bettingbet-online-betting-classified-stakes
2024-06-07T05:42:24Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870097
2024-06-07T05:42:26Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/1815/4/2/british-stallion-studs-ebf-restricted-maiden-stakes
2024-06-07T05:42:27Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870098
2024-06-07T05:42:30Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/1845/4/3/bettingbet-live-racing-results-handicap
2024-06-07T05:42:32Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870099
2024-06-07T05:42:34Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/1915/4/4/bettingbet-free-horse-racing-tips-handicap
2024-06-07T05:42:38Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870100
2024-06-07T05:42:38Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/1950/4/5/bettingbet-horseracing-odds-handicap
2024-06-07T05:42:41Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/2025/4/6/bettingbet-new-betting-sites-handicap
2024-06-07T05:42:41Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870101
2024-06-07T05:42:46Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bath/2024-06-07/2100/4/7/mitchell--co-handicap
2024-06-07T05:42:47Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870102
2024-06-07T05:42:50Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1400/6/1/ak-bets-home-of-free-bets-apprentice-handicap
2024-06-07T05:42:52Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1430/6/2/ak-bets-best-price-euro-2024-restricted-maiden-stakes
2024-06-07T05:42:53Z | INFO - Scraping data from: https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870103
2024-06-07T05:42:54Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1500/6/3/download-the-ak-bets-app-classified-stakes
2024-06-07T05:42:58Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1530/6/4/ak-bets-watch-all-uk-racing-classified-stakes
2024-06-07T05:43:00Z | WARNING - Runner Rock On Pedro is a reserve
2024-06-07T05:43:00Z | WARNING - Runner Tuff Days is a reserve
2024-06-07T05:43:00Z | WARNING - Runner Carslake is a reserve
2024-06-07T05:43:00Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870104
2024-06-07T05:43:01Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1600/6/5/ak-bets-big-prices-big-limits-confined-handicap
2024-06-07T05:43:04Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870105
2024-06-07T05:43:05Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1630/6/6/ak-bets-chat-to-a-trader-handicap
2024-06-07T05:43:07Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870106
2024-06-07T05:43:08Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/brighton/2024-06-07/1705/6/7/ak-bets-emile-heskey-euros-video-handicap
2024-06-07T05:43:11Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/1720/203/1/powerstown-park-beginners-chase
2024-06-07T05:43:12Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870107
2024-06-07T05:43:16Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/1750/203/2/botanica-international--opportunity-handicap-chase
2024-06-07T05:43:17Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870108
2024-06-07T05:43:20Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870109
2024-06-07T05:43:20Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/1820/203/3/bulmers-summer-bbq-race-evening-beginners-chase
2024-06-07T05:43:24Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870110
2024-06-07T05:43:26Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/1850/203/4/bulmers-original-novice-chase
2024-06-07T05:43:28Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/1920/203/5/bulmers-zero
2024-06-07T05:43:29Z | INFO - Scraping data from: https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870608
2024-06-07T05:43:35Z | INFO - Scraping data from: https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868012
2024-06-07T05:43:35Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/1955/203/6/bulmers-light-beginners-chase
2024-06-07T05:43:39Z | INFO - Scraping data from: https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868013
2024-06-07T05:43:41Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/clonmel/2024-06-07/2030/203/7/clonmel-show-july-27th-handicap-chase
2024-06-07T05:43:42Z | INFO - Scraping data from: https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868014
2024-06-07T05:43:47Z | INFO - Scraping data from: https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868015
2024-06-07T05:43:48Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1635/208/1/irish-stallion-farms-ebf-maiden
2024-06-07T05:43:50Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1710/208/2/irish-stallion-farms-ebf-median-auction
2024-06-07T05:43:52Z | INFO - Scraping data from: https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868016
2024-06-07T05:43:53Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1740/208/3/tote-handicap
2024-06-07T05:43:56Z | INFO - Scraping data from: https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868017
2024-06-07T05:43:57Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1810/208/4/cpac-modular-maiden
2024-06-07T05:44:00Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/867985
2024-06-07T05:44:01Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1840/208/5/tote-maiden
2024-06-07T05:44:03Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1910/208/6/tote-handicap
2024-06-07T05:44:04Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/867986
2024-06-07T05:44:06Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/1942/208/7/dino-day-on-10th-july-handicap
2024-06-07T05:44:08Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/867987
2024-06-07T05:44:12Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/867988
2024-06-07T05:44:12Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/fairyhouse/2024-06-07/2017/208/8/dino-day-on-10th-july-handicap
2024-06-07T05:44:18Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/867989
2024-06-07T05:44:19Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/goodwood/2024-06-07/1805/20/1/william-hill-daily-boost-apprentice-handicap
2024-06-07T05:44:23Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/goodwood/2024-06-07/1835/20/2/william-hill-epic-value-apprentice-fillies-novice-stakes
2024-06-07T05:44:25Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/867990
2024-06-07T05:44:27Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/goodwood/2024-06-07/1905/20/3/degen-distillery-x-malatonka-apprentice-fillies-handicap
2024-06-07T05:44:29Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-07/870611
2024-06-07T05:44:31Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/goodwood/2024-06-07/1935/20/4/william-hill-extra-place-races-apprentice-handicap
2024-06-07T05:44:34Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867863
2024-06-07T05:44:36Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/goodwood/2024-06-07/2010/20/5/degen-distillery-x-berniemanski-apprentice-handicap
2024-06-07T05:44:40Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/goodwood/2024-06-07/2045/20/6/grahame-carter-remembrance-gallop-apprentice-handicap
2024-06-07T05:44:41Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867864
2024-06-07T05:44:43Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/1728/22/1/betfred-bet-builder-amateur-jockeys-handicap
2024-06-07T05:44:46Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867865
2024-06-07T05:44:48Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/1758/22/2/betfred-supports-jack-berry-house-novice-stakes
2024-06-07T05:44:50Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867866
2024-06-07T05:44:51Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/1828/22/3/betfred-supports-jack-berry-house-novice-stakes
2024-06-07T05:44:54Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/1858/22/4/betfred-nifty-50-handicap
2024-06-07T05:44:54Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867867
2024-06-07T05:44:59Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867868
2024-06-07T05:45:00Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/1928/22/5/betfred-play-freds-5-million-fillies-handicap
2024-06-07T05:45:03Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/2003/22/6/betfred-challenge-cup-final-ebf-novice-stakes
2024-06-07T05:45:05Z | INFO - Scraping data from: https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/870609
2024-06-07T05:45:05Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-07/2038/22/7/betfred-join-our-sports-club-handicap
2024-06-07T05:45:08Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/867998
2024-06-07T05:45:09Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1348/33/1/aquadi-by-symphony-mares-maiden-hurdle
2024-06-07T05:45:13Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1418/33/2/linear-by-symphony-handicap-chase
2024-06-07T05:45:13Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/867999
2024-06-07T05:45:17Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/868000
2024-06-07T05:45:19Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1448/33/3/gallery-by-symphony-handicap-hurdle
2024-06-07T05:45:21Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/868001
2024-06-07T05:45:22Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1518/33/4/gallery-by-symphony-handicap-hurdle
2024-06-07T05:45:24Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/868002
2024-06-07T05:45:26Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1548/33/5/symphony-group-handicap-hurdle
2024-06-07T05:45:28Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/868003
2024-06-07T05:45:30Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1620/33/6/urbano-by-symphony-novices-handicap-chase
2024-06-07T05:45:33Z | INFO - Scraping data from: https://www.racingpost.com/racecards/5/bath/2024-06-07/868004
2024-06-07T05:45:33Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/market-rasen/2024-06-07/1650/33/7/gallery-premium-partners-handicap-hurdle
2024-06-07T05:45:35Z | WARNING - Runner Alainn Tu is a non-runner
2024-06-07T05:45:37Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868005
2024-06-07T05:45:38Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1338/51/1/vickersbet-best-odds-guaranteed-everyday-handicap
2024-06-07T05:45:41Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868006
2024-06-07T05:45:41Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1408/51/2/vickersbet-restricted-maiden-stakes
2024-06-07T05:45:43Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868007
2024-06-07T05:45:44Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1438/51/3/join-our-free-bet-club-at-vickersbet-handicap
2024-06-07T05:45:46Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868008
2024-06-07T05:45:49Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1508/51/4/follow-vickersracing-on-x-handicap
2024-06-07T05:45:50Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868009
2024-06-07T05:45:52Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1538/51/5/follow-vickersracing-on-x-handicap
2024-06-07T05:45:53Z | WARNING - Runner On The Nose is a non-runner
2024-06-07T05:45:54Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868010
2024-06-07T05:45:56Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1608/51/6/download-the-vickersbet-app-fillies-handicap
2024-06-07T05:45:57Z | INFO - Scraping data from: https://www.racingpost.com/racecards/7/brighton/2024-06-07/868011
2024-06-07T05:46:01Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868018
2024-06-07T05:46:01Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/thirsk/2024-06-07/1640/51/7/vickersbet-independent-family-owned-bookmaker-handicap
2024-06-07T05:46:04Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868019
2024-06-07T05:46:07Z | INFO - Converting data...
2024-06-07T05:46:07Z | INFO - Data converted successfully
2024-06-07T05:46:07Z | INFO - Sorting data...
2024-06-07T05:46:07Z | INFO - Data Columns Index(['horse_name', 'horse_id', 'sire_name', 'sire_id', 'dam_name', 'dam_id',
       'trainer_name', 'trainer_id', 'jockey_name', 'jockey_id', 'course_id',
       'course', 'race_date', 'race_timestamp', 'race', 'age_range',
       'hcap_range', 'prize', 'unique_id', 'finishing_position',
       'fractional_price', 'main_race_comment', 'draw', 'tf_rating',
       'tf_speed_figure', 'betfair_win_sp', 'going', 'in_play_prices',
       'debug_link', 'equipment', 'official_rating', 'race_id',
       'betfair_place_sp', 'distance', 'horse_name_link', 'race_type',
       'tf_comment', 'horse_age', 'race_time', 'created_at'],
      dtype='object')
2024-06-07T05:46:07Z | INFO - Data Sample         horse_name      horse_id  ... race_time                 created_at
0    Admirable Lad  000000530379  ...      None 2024-06-07 05:42:26.628964
1        Alainn Tu  000000570409  ...      None 2024-06-07 05:42:26.628964
2  Captain Bentley  000000595627  ...      None 2024-06-07 05:42:26.628964
3   Glamorous Star  000000561986  ...      None 2024-06-07 05:42:26.628964
4       Higher Law  000000577112  ...      None 2024-06-07 05:42:26.628964
5            Katar  000000564120  ...      None 2024-06-07 05:42:26.628964
6      Lynwood Lad  000000562035  ...      None 2024-06-07 05:42:26.628964
7   Midnight Flame  000000568986  ...      None 2024-06-07 05:42:26.628964
8          Mintana  000000566456  ...      None 2024-06-07 05:42:26.628964
9   Neptune Legend  000000548092  ...      None 2024-06-07 05:42:26.628964

[10 rows x 40 columns]
2024-06-07T05:46:07Z | INFO - Data Sample    tf_rating  ...                                          unique_id
13      None  ...  2b58545895c4e749d611253d51092755caa26b52f19d85...
6       None  ...  56186d98522412da2f4de1e50104c2048c0e74a847e9d0...
0       None  ...  8a1ac8986b252e12a7cb9effb94a2ba054224911e5e35a...
1       None  ...  6a215fdc8191fe89df4d5f83e8c3b18d39deb77413ede2...
2       None  ...  5a08274a1bc48875267d4e075b5d1c3c98867d042b1ba4...
3       None  ...  d2f3d978615a8bc148e0ed767021bf7516dce32183114a...
5       None  ...  348baa147f028039cd2b25d7b350d03e3bb14cbaa9cdbb...
4       None  ...  4ccaa9febd6e1c9e1db3f58b2a1c4dc36210b5ac23fd59...
7       None  ...  bf2fb9ce48a56a7d70397ce0d4d9c111dd7efa846c3c59...
8       None  ...  627bd55770a7a4a6c09ea3b7b4b84282e3af913f6f4ed9...

[10 rows x 40 columns]
2024-06-07T05:46:07Z | INFO - Validating data...
2024-06-07T05:46:07Z | INFO - Data validated successfully
2024-06-07T05:46:07Z | INFO - Sorting data...
2024-06-07T05:46:07Z | INFO - Data Columns Index(['tf_rating', 'tf_speed_figure', 'draw', 'trainer_name', 'trainer_id',
       'jockey_name', 'jockey_id', 'sire_name', 'sire_id', 'dam_name',
       'dam_id', 'finishing_position', 'horse_name', 'horse_id',
       'horse_name_link', 'horse_age', 'equipment', 'official_rating',
       'fractional_price', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'course', 'race_date', 'race_time',
       'race_timestamp', 'course_id', 'race', 'race_id', 'distance', 'going',
       'prize', 'hcap_range', 'age_range', 'race_type', 'main_race_comment',
       'debug_link', 'created_at', 'unique_id'],
      dtype='object')
2024-06-07T05:46:07Z | INFO - Data Sample    tf_rating  ...                                          unique_id
13      None  ...  2b58545895c4e749d611253d51092755caa26b52f19d85...
6       None  ...  56186d98522412da2f4de1e50104c2048c0e74a847e9d0...
0       None  ...  8a1ac8986b252e12a7cb9effb94a2ba054224911e5e35a...
1       None  ...  6a215fdc8191fe89df4d5f83e8c3b18d39deb77413ede2...
2       None  ...  5a08274a1bc48875267d4e075b5d1c3c98867d042b1ba4...
3       None  ...  d2f3d978615a8bc148e0ed767021bf7516dce32183114a...
5       None  ...  348baa147f028039cd2b25d7b350d03e3bb14cbaa9cdbb...
4       None  ...  4ccaa9febd6e1c9e1db3f58b2a1c4dc36210b5ac23fd59...
7       None  ...  bf2fb9ce48a56a7d70397ce0d4d9c111dd7efa846c3c59...
8       None  ...  627bd55770a7a4a6c09ea3b7b4b84282e3af913f6f4ed9...

[10 rows x 40 columns]
2024-06-07T05:46:07Z | INFO - Data Sample    tf_rating  ...                                          unique_id
13      None  ...  2b58545895c4e749d611253d51092755caa26b52f19d85...
7       None  ...  bf2fb9ce48a56a7d70397ce0d4d9c111dd7efa846c3c59...
6       None  ...  56186d98522412da2f4de1e50104c2048c0e74a847e9d0...
12      None  ...  8d8e9f077b9a47b8c6ecc972ec8943b40e8864aeb6169e...
11      None  ...  0f5208f74097d760767dd2f0475b44c8c9c701fe53d312...
10      None  ...  e1002b63b18a36cda804f19ad07d6edda4f86ad158c831...
8       None  ...  627bd55770a7a4a6c09ea3b7b4b84282e3af913f6f4ed9...
9       None  ...  11b5568eabbf4b9b579c00b60b73ae840cc7f5503dfdbe...
4       None  ...  4ccaa9febd6e1c9e1db3f58b2a1c4dc36210b5ac23fd59...
5       None  ...  348baa147f028039cd2b25d7b350d03e3bb14cbaa9cdbb...

[10 rows x 40 columns]
2024-06-07T05:46:07Z | INFO - Fetching data with query: SELECT * FROM tf_raw.todays_performance_data
2024-06-07T05:46:07Z | INFO - Truncating tf_raw.todays_performance_data
2024-06-07T05:46:07Z | INFO - Executing query: TRUNCATE TABLE tf_raw.todays_performance_data
2024-06-07T05:46:08Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:46:08Z | INFO - Storing 584 records in tf_raw.todays_performance_data
2024-06-07T05:46:08Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868020
2024-06-07T05:46:09Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_todays_tf_data'
2024-06-07T05:46:09Z | INFO - Query executed. Number of rows affected: 1
2024-06-07T05:46:12Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868021
2024-06-07T05:46:17Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868022
2024-06-07T05:46:21Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868023
2024-06-07T05:46:25Z | INFO - Scraping data from: https://www.racingpost.com/racecards/80/thirsk/2024-06-07/870610
2024-06-07T05:46:29Z | INFO - Converting data...
2024-06-07T05:46:29Z | INFO - Data converted successfully
2024-06-07T05:46:29Z | INFO - Sorting data...
2024-06-07T05:46:29Z | INFO - Data Columns Index(['horse_name', 'horse_id', 'horse_type', 'sire_name', 'sire_id',
       'dam_name', 'dam_id', 'owner_name', 'owner_id', 'jockey_name',
       'jockey_id', 'trainer_name', 'trainer_id', 'headgear', 'horse_age',
       'horse_weight', 'jockey_claim', 'draw', 'official_rating', 'course_id',
       'course_name', 'course', 'race_date', 'race_id', 'race_timestamp',
       'first_place_prize_money', 'number_of_runners', 'going', 'distance',
       'distance_full', 'race_title', 'conditions', 'surface', 'race_time',
       'horse_price', 'finishing_position', 'rpr_value', 'debug_link',
       'total_distance_beaten', 'ts_value', 'total_prize_money', 'currency',
       'winning_time', 'dams_sire_id', 'extra_weight', 'dams_sire', 'comment',
       'country', 'created_at', 'unique_id', 'meeting_id', 'race_class'],
      dtype='object')
2024-06-07T05:46:29Z | INFO - Data Sample           horse_name  ... race_class
0      Action Motion  ...        NaN
1            Bua Boy  ...        NaN
2      Master Player  ...        NaN
3            Sawbuck  ...        NaN
4   The Shantou King  ...        NaN
5  Tippin And Tappin  ...        NaN
6       Walnut Beach  ...        NaN
7         Zolpharine  ...        NaN
8           Faux Fur  ...        NaN
9               Idol  ...        NaN

[10 rows x 52 columns]
2024-06-07T05:46:29Z | INFO - Data Sample        race_timestamp  ...                 created_at
9 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
8 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
7 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
6 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
5 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
4 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
3 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
2 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
1 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
0 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802

[10 rows x 52 columns]
2024-06-07T05:46:29Z | INFO - Validating data...
2024-06-07T05:46:29Z | INFO - Data validated successfully
2024-06-07T05:46:29Z | INFO - Sorting data...
2024-06-07T05:46:29Z | INFO - Data Columns Index(['race_timestamp', 'race_date', 'course_name', 'race_class',
       'horse_name', 'horse_type', 'horse_age', 'headgear', 'conditions',
       'horse_price', 'race_title', 'distance', 'distance_full', 'going',
       'number_of_runners', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'official_rating', 'horse_weight', 'draw', 'country',
       'surface', 'finishing_position', 'total_distance_beaten', 'ts_value',
       'rpr_value', 'extra_weight', 'comment', 'race_time', 'currency',
       'course', 'jockey_name', 'jockey_claim', 'trainer_name', 'sire_name',
       'dam_name', 'dams_sire', 'owner_name', 'horse_id', 'trainer_id',
       'jockey_id', 'sire_id', 'dam_id', 'dams_sire_id', 'owner_id', 'race_id',
       'course_id', 'meeting_id', 'unique_id', 'debug_link', 'created_at'],
      dtype='object')
2024-06-07T05:46:29Z | INFO - Data Sample        race_timestamp  ...                 created_at
9 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
8 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
7 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
6 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
5 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
4 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
3 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
2 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
1 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
0 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802

[10 rows x 52 columns]
2024-06-07T05:46:29Z | INFO - Data Sample        race_timestamp  ...                 created_at
9 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
7 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
6 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
5 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
4 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
3 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
2 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
1 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
0 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802
8 2024-06-07 15:38:00  ... 2024-06-07 05:46:29.468802

[10 rows x 52 columns]
2024-06-07T05:46:29Z | INFO - Fetching data with query: SELECT * FROM rp_raw.todays_performance_data
2024-06-07T05:46:29Z | INFO - Truncating rp_raw.todays_performance_data
2024-06-07T05:46:29Z | INFO - Executing query: TRUNCATE TABLE rp_raw.todays_performance_data
2024-06-07T05:46:29Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:46:29Z | INFO - Storing 580 records in rp_raw.todays_performance_data
2024-06-07T05:46:31Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_todays_rp_data'
2024-06-07T05:46:31Z | INFO - Query executed. Number of rows affected: 1
['https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870097', 'https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870098', 'https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870099', 'https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870100', 'https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870101', 'https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870102', 'https://www.racingpost.com/racecards/177/clonmel/2024-06-07/870103', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870104', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870105', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870106', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870107', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870108', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870109', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870110', 'https://www.racingpost.com/racecards/182/fairyhouse/2024-06-07/870608', 'https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868012', 'https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868013', 'https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868014', 'https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868015', 'https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868016', 'https://www.racingpost.com/racecards/21/goodwood/2024-06-07/868017', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/867985', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/867986', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/867987', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/867988', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/867989', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/867990', 'https://www.racingpost.com/racecards/23/haydock/2024-06-07/870611', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867863', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867864', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867865', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867866', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867867', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/867868', 'https://www.racingpost.com/racecards/35/market-rasen/2024-06-07/870609', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/867998', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/867999', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/868000', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/868001', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/868002', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/868003', 'https://www.racingpost.com/racecards/5/bath/2024-06-07/868004', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868005', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868006', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868007', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868008', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868009', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868010', 'https://www.racingpost.com/racecards/7/brighton/2024-06-07/868011', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868018', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868019', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868020', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868021', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868022', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/868023', 'https://www.racingpost.com/racecards/80/thirsk/2024-06-07/870610']
2024-06-07T05:46:34Z | INFO - Todays RP results data scraping started.
2024-06-07T05:46:34Z | INFO - Todays TF results data scraping started.
2024-06-07T05:46:34Z | INFO - Fetching data with query: 
        SELECT * FROM public.course cr
        left join public.country ct on 
        cr.country_id::text = ct.country_id::text
        
2024-06-07T05:46:34Z | INFO - Fetching data with query: 
        SELECT * FROM public.course cr
        left join public.country ct on 
        cr.country_id::text = ct.country_id::text
        
2024-06-07T05:46:34Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:46:34Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:46:34Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-06-07T05:46:34Z | INFO - Creating a new WebDriver with headless mode set to True
2024-06-07T05:46:36Z | INFO - Clicked on button for date: 2024-06-08
2024-06-07T05:46:41Z | INFO - Toggling settings button
2024-06-07T05:46:47Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1340/3/1/cheshire-oaks-designer-outlet-novices-hurdle
2024-06-07T05:46:50Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868031
2024-06-07T05:46:51Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1415/3/2/castle-mews-windows-handicap-chase
2024-06-07T05:46:54Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868032
2024-06-07T05:46:55Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1450/3/3/rachel-jones-memorial-handicap-hurdle
2024-06-07T05:46:58Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868033
2024-06-07T05:46:59Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1525/3/4/brooke-rankin-ladies-day-novices-handicap-chase
2024-06-07T05:47:04Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1600/3/5/rw-hough--sons-novices-handicap-hurdle
2024-06-07T05:47:07Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868034
2024-06-07T05:47:09Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1635/3/6/mike--jill-medcalf-70th-birthday-mares-handicap-chase
2024-06-07T05:47:14Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/bangor-on-dee/2024-06-08/1710/3/7/cheshire-oaks-designer-outlet-open-national-hunt-flat
2024-06-07T05:47:15Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868035
2024-06-07T05:47:17Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1330/5/1/bet365-very-british-raceday-restricted-maiden-stakes
2024-06-07T05:47:20Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1405/5/2/hilary-needler-trophy-ebf-fillies-conditions-stakes
2024-06-07T05:47:24Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1440/5/3/bet365-two-year-old-trophy-conditions-stakes
2024-06-07T05:47:25Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868036
2024-06-07T05:47:26Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1515/5/4/bet365-handicap
2024-06-07T05:47:30Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/868037
2024-06-07T05:47:34Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1550/5/5/best-odds-guaranteed-at-bet365-handicap
2024-06-07T05:47:36Z | INFO - Scraping data from: https://www.racingpost.com/racecards/10/catterick/2024-06-08/870637
2024-06-07T05:47:38Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1625/5/6/never-ordinary-at-bet365-handicap
2024-06-07T05:47:41Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/beverley/2024-06-08/1700/5/7/bet-boost-at-bet365-handicap
2024-06-07T05:47:43Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868038
2024-06-07T05:47:46Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1410/9/1/pennine-brewing-company-restricted-maiden-fillies-stakes
2024-06-07T05:47:48Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868039
2024-06-07T05:47:48Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1445/9/2/congratulations-erin-on-getting-married-handicap
2024-06-07T05:47:51Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868040
2024-06-07T05:47:54Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1520/9/3/congratulations-erin-on-getting-married-handicap
2024-06-07T05:47:56Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868041
2024-06-07T05:48:00Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868042
2024-06-07T05:48:03Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1555/9/4/w-g-spink-handicap
2024-06-07T05:48:04Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868043
2024-06-07T05:48:08Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868044
2024-06-07T05:48:09Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1630/9/5/ets-uk-limited-40th-anniversary-handicap
2024-06-07T05:48:12Z | INFO - Scraping data from: https://www.racingpost.com/racecards/12/chepstow/2024-06-08/870636
2024-06-07T05:48:14Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1705/9/6/best-odds-guaranteed-at-vickersbet-handicap
2024-06-07T05:48:16Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870170
2024-06-07T05:48:19Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1740/9/7/free-racing-tv-at-racingtvcom-freetrial-handicap
2024-06-07T05:48:22Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/catterick-bridge/2024-06-08/1810/9/8/racing-tv-free-trial-handicap
2024-06-07T05:48:23Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870171
2024-06-07T05:48:26Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870172
2024-06-07T05:48:26Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/1725/11/1/download-the-vickersbet-app-handicap
2024-06-07T05:48:30Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/1800/11/2/vickersbet-independent-family-owned-bookmaker-ebf-restricted-maiden-fillies-stakes
2024-06-07T05:48:32Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/1830/11/3/memory-of-gwilym-llewellyn-brain-tumour-research-handicap
2024-06-07T05:48:35Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/1900/11/4/vickersbet-handicap
2024-06-07T05:48:35Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870173
2024-06-07T05:48:40Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870174
2024-06-07T05:48:40Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/1930/11/5/michael-maine-memorial-handicap
2024-06-07T05:48:43Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870175
2024-06-07T05:48:45Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/2000/11/6/best-odds-guaranteed-at-vickersbet-everyday-handicap
2024-06-07T05:48:49Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/2030/11/7/best-odds-guaranteed-at-vickersbet-everyday-handicap
2024-06-07T05:48:50Z | INFO - Scraping data from: https://www.racingpost.com/racecards/193/navan/2024-06-08/870176
2024-06-07T05:48:54Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/chepstow/2024-06-08/2100/11/8/join-our-free-bet-club-at-vickersbet-handicap
2024-06-07T05:48:57Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1350/22/1/betfred-passionate-about-sport-achilles-stakes
2024-06-07T05:48:59Z | WARNING - Runner Storm Eric is a reserve
2024-06-07T05:48:59Z | WARNING - Runner Higher Kingdom is a reserve
2024-06-07T05:48:59Z | WARNING - Runner Tasmanian Girl is a reserve
2024-06-07T05:48:59Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870153
2024-06-07T05:49:00Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1425/22/2/betfred-play-freds-5-million-handicap
2024-06-07T05:49:02Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870154
2024-06-07T05:49:06Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1500/22/3/betfred-nifty-50-lester-piggott-fillies-stakes
2024-06-07T05:49:08Z | WARNING - Runner Tuscaloosa Anna is a reserve
2024-06-07T05:49:08Z | WARNING - Runner Jim's Cracker is a reserve
2024-06-07T05:49:08Z | WARNING - Runner Rampere West is a reserve
2024-06-07T05:49:08Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870155
2024-06-07T05:49:11Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1535/22/4/betfred-john-of-gaunt-stakes
2024-06-07T05:49:15Z | WARNING - Runner Colorado Charlie is a reserve
2024-06-07T05:49:15Z | WARNING - Runner Dairy Force is a reserve
2024-06-07T05:49:15Z | WARNING - Runner Truckers Cruising is a reserve
2024-06-07T05:49:15Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870156
2024-06-07T05:49:16Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1610/22/5/betfred-supports-jack-berry-house-handicap
2024-06-07T05:49:20Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1645/22/6/betfred-join-our-sports-club-reverence-handicap
2024-06-07T05:49:23Z | WARNING - Runner Leis Fein is a reserve
2024-06-07T05:49:23Z | WARNING - Runner Cloughroe is a reserve
2024-06-07T05:49:23Z | WARNING - Runner Miss Vivacious is a reserve
2024-06-07T05:49:23Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870157
2024-06-07T05:49:27Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1720/22/7/betfred-bet-builder-sankey-handicap
2024-06-07T05:49:27Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870158
2024-06-07T05:49:30Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/haydock-park/2024-06-08/1752/22/8/betfred-bet-builder-sankey-handicap
2024-06-07T05:49:31Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870159
2024-06-07T05:49:34Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/1745/30/1/download-the-raceday-ready-app-handicap
2024-06-07T05:49:36Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/1815/30/2/get-raceday-ready-restricted-novice-stakes
2024-06-07T05:49:37Z | INFO - Scraping data from: https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870634
2024-06-07T05:49:38Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/1845/30/3/ben-martin-big-birthday-bash-handicap
2024-06-07T05:49:41Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/1915/30/4/get-the-inside-track-with-raceday-readycom-handicap
2024-06-07T05:49:43Z | WARNING - Runner Mayos Vendangeur is a reserve
2024-06-07T05:49:43Z | WARNING - Runner Katherine is a reserve
2024-06-07T05:49:43Z | WARNING - Runner Hurricane Honey is a reserve
2024-06-07T05:49:43Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867991
2024-06-07T05:49:44Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/1945/30/5/tips-for-every-race-at-raceday-readycom-restricted-maiden-stakes
2024-06-07T05:49:45Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/2015/30/6/download-the-raceday-ready-app-handicap
2024-06-07T05:49:47Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867992
2024-06-07T05:49:52Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/lingfield-park/2024-06-08/2045/30/7/download-the-racecourse-app-raceday-ready-handicap
2024-06-07T05:49:52Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867993
2024-06-07T05:49:55Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867994
2024-06-07T05:49:55Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1345/220/1/lynn-lodge-stud-irish-ebf-maiden
2024-06-07T05:49:58Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1420/220/2/navan-racecourse-handicap
2024-06-07T05:49:59Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867995
2024-06-07T05:50:01Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1455/220/3/gain-the-advantage-series-handicap
2024-06-07T05:50:04Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867996
2024-06-07T05:50:06Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1530/220/4/darley-irish-ebf-kooyonga-stakes
2024-06-07T05:50:07Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/867997
2024-06-07T05:50:10Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1605/220/5/tri-equestrian
2024-06-07T05:50:11Z | INFO - Scraping data from: https://www.racingpost.com/racecards/23/haydock/2024-06-08/870635
2024-06-07T05:50:13Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1640/220/6/irish-stallion-farms-ebf-median-auction-fillies-maiden
2024-06-07T05:50:14Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868045
2024-06-07T05:50:16Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/navan/2024-06-08/1715/220/7/cusack-hotel-group-family-raceday-july-13th-handicap
2024-06-07T05:50:17Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868046
2024-06-07T05:50:20Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868047
2024-06-07T05:50:22Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868048
2024-06-07T05:50:25Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1322/222/1/ladbrokes-we-play-together-novice-hurdle
2024-06-07T05:50:26Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868049
2024-06-07T05:50:28Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1357/222/2/ladbrokes-5-a-side-handicap-chase
2024-06-07T05:50:29Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868050
2024-06-07T05:50:31Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1432/222/3/ladbrokes-handicap-chase
2024-06-07T05:50:34Z | INFO - Scraping data from: https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868051
2024-06-07T05:50:36Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1507/222/4/ladbrokes-2upwin-maiden-hurdle
2024-06-07T05:50:37Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867869
2024-06-07T05:50:40Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867870
2024-06-07T05:50:44Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1542/222/5/ladbrokes-daily-odds-boost-maiden-hurdle
2024-06-07T05:50:44Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867871
2024-06-07T05:50:48Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867872
2024-06-07T05:50:49Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1617/222/6/ladbrokes-play-1-2-free-on-football-handicap-hurdle
2024-06-07T05:50:51Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867873
2024-06-07T05:50:55Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867874
2024-06-07T05:50:57Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1652/222/7/ladbrokes-play-1-2-free-on-football-handicap-hurdle
2024-06-07T05:50:59Z | INFO - Scraping data from: https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867875
2024-06-07T05:51:03Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868024
2024-06-07T05:51:04Z | INFO - Scraping data from: https://www.timeform.com/horse-racing/racecards/punchestown/2024-06-08/1727/222/8/northway-personnel
2024-06-07T05:51:05Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868025
2024-06-07T05:51:07Z | INFO - Converting data...
2024-06-07T05:51:07Z | INFO - Data converted successfully
2024-06-07T05:51:07Z | INFO - Sorting data...
2024-06-07T05:51:07Z | INFO - Data Columns Index(['horse_name', 'horse_id', 'sire_name', 'sire_id', 'dam_name', 'dam_id',
       'trainer_name', 'trainer_id', 'jockey_name', 'jockey_id', 'course_id',
       'course', 'race_date', 'race_timestamp', 'race', 'age_range',
       'hcap_range', 'prize', 'unique_id', 'finishing_position',
       'fractional_price', 'main_race_comment', 'draw', 'tf_rating',
       'tf_speed_figure', 'betfair_win_sp', 'going', 'in_play_prices',
       'debug_link', 'equipment', 'official_rating', 'race_id',
       'betfair_place_sp', 'distance', 'horse_name_link', 'race_type',
       'tf_comment', 'horse_age', 'race_time', 'created_at'],
      dtype='object')
2024-06-07T05:51:07Z | INFO - Data Sample         horse_name      horse_id  ... race_time                 created_at
0         Chantico  000000575232  ...      None 2024-06-07 05:46:51.631514
1      Dun Dancing  000000609460  ...      None 2024-06-07 05:46:51.631514
2   Grandpas Folly  000000589587  ...      None 2024-06-07 05:46:51.631514
3  Nippin N Poppin  000000575602  ...      None 2024-06-07 05:46:51.631514
4  Peruvian Summer  000000495184  ...      None 2024-06-07 05:46:51.631514
5        Pub Crawl  000000555608  ...      None 2024-06-07 05:46:51.631514
6      Upagainstit  000000563979  ...      None 2024-06-07 05:46:51.631514
7      Urs Fischer  000000527488  ...      None 2024-06-07 05:46:51.631514
8  Gwennie May Jem  000000596088  ...      None 2024-06-07 05:46:51.631514
9          Kintaro  000000577309  ...      None 2024-06-07 05:46:51.631514

[10 rows x 40 columns]
2024-06-07T05:51:07Z | INFO - Data Sample    tf_rating  ...                                          unique_id
19      None  ...  64ff8eef438bcb58bd988c679a93ce2cf321d9169bd4e2...
9       None  ...  8e79d559a577053f8dcd53c9149a7e659149f5eb15aa8b...
0       None  ...  432b64d4354a69f69fdba68a0995872ca875d7fdc90fa1...
1       None  ...  ec03af044574a1a90dbb2a977bf13734cc1711b2b0e412...
2       None  ...  c5ae2f89cd2f421b8fa375519e593d53e64fcf407b40b9...
3       None  ...  acfadbe57b006e061d0d80d04d6245cb8f3fc260592449...
4       None  ...  c997cdec921b7f976e26741d9cb5cb19ee3c1b0236cd88...
6       None  ...  a36c72ef4ceb923fa0d28d374e57d03090c2c114bed9f7...
7       None  ...  fee6988afcadf1b251e1f35190d3c8ea25d0e3fab80539...
8       None  ...  37cf95b3d7ef8f6a5dc6bcaa41ec0b02e42d9801a701ca...

[10 rows x 40 columns]
2024-06-07T05:51:07Z | INFO - Validating data...
2024-06-07T05:51:07Z | INFO - Data validated successfully
2024-06-07T05:51:07Z | INFO - Sorting data...
2024-06-07T05:51:07Z | INFO - Data Columns Index(['tf_rating', 'tf_speed_figure', 'draw', 'trainer_name', 'trainer_id',
       'jockey_name', 'jockey_id', 'sire_name', 'sire_id', 'dam_name',
       'dam_id', 'finishing_position', 'horse_name', 'horse_id',
       'horse_name_link', 'horse_age', 'equipment', 'official_rating',
       'fractional_price', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'course', 'race_date', 'race_time',
       'race_timestamp', 'course_id', 'race', 'race_id', 'distance', 'going',
       'prize', 'hcap_range', 'age_range', 'race_type', 'main_race_comment',
       'debug_link', 'created_at', 'unique_id'],
      dtype='object')
2024-06-07T05:51:07Z | INFO - Data Sample    tf_rating  ...                                          unique_id
19      None  ...  64ff8eef438bcb58bd988c679a93ce2cf321d9169bd4e2...
9       None  ...  8e79d559a577053f8dcd53c9149a7e659149f5eb15aa8b...
0       None  ...  432b64d4354a69f69fdba68a0995872ca875d7fdc90fa1...
1       None  ...  ec03af044574a1a90dbb2a977bf13734cc1711b2b0e412...
2       None  ...  c5ae2f89cd2f421b8fa375519e593d53e64fcf407b40b9...
3       None  ...  acfadbe57b006e061d0d80d04d6245cb8f3fc260592449...
4       None  ...  c997cdec921b7f976e26741d9cb5cb19ee3c1b0236cd88...
6       None  ...  a36c72ef4ceb923fa0d28d374e57d03090c2c114bed9f7...
7       None  ...  fee6988afcadf1b251e1f35190d3c8ea25d0e3fab80539...
8       None  ...  37cf95b3d7ef8f6a5dc6bcaa41ec0b02e42d9801a701ca...

[10 rows x 40 columns]
2024-06-07T05:51:07Z | INFO - Data Sample    tf_rating  ...                                          unique_id
19      None  ...  64ff8eef438bcb58bd988c679a93ce2cf321d9169bd4e2...
10      None  ...  e2d111b9f38e354178052dabf3d4fd9ca177689bc67137...
9       None  ...  8e79d559a577053f8dcd53c9149a7e659149f5eb15aa8b...
12      None  ...  cfab6efc83b32d16ece5ff8849134a0f6bf7fe33d8ef7a...
13      None  ...  38f35df7d0365f72c1d1369fb399edfafb86283a0379e8...
14      None  ...  3f58c4dc1daad26876b6662a525ab22986e76b36e23210...
18      None  ...  4dcc3152f329c090005cc23107c985b153edb6667719a6...
17      None  ...  6baad42abd24f3bbe7ce7bb74a6ecc9c546474921c5264...
11      None  ...  cba33811be1e14f0f29c7666732427313837f2755e5832...
15      None  ...  16e07566fd080a0ef4c1504d4c0f4cb61ab21a1337f999...

[10 rows x 40 columns]
2024-06-07T05:51:07Z | INFO - Fetching data with query: SELECT * FROM tf_raw.todays_performance_data
2024-06-07T05:51:08Z | INFO - Truncating tf_raw.todays_performance_data
2024-06-07T05:51:08Z | INFO - Executing query: TRUNCATE TABLE tf_raw.todays_performance_data
2024-06-07T05:51:08Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:51:08Z | INFO - Storing 1257 records in tf_raw.todays_performance_data
2024-06-07T05:51:09Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_todays_tf_data'
2024-06-07T05:51:09Z | INFO - Query executed. Number of rows affected: 1
2024-06-07T05:51:10Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868026
2024-06-07T05:51:14Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868027
2024-06-07T05:51:17Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868028
2024-06-07T05:51:19Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868029
2024-06-07T05:51:21Z | INFO - Scraping data from: https://www.racingpost.com/racecards/6/beverley/2024-06-08/868030
2024-06-07T05:51:25Z | INFO - Converting data...
2024-06-07T05:51:25Z | INFO - Data converted successfully
2024-06-07T05:51:25Z | INFO - Sorting data...
2024-06-07T05:51:25Z | INFO - Data Columns Index(['horse_name', 'horse_id', 'horse_type', 'sire_name', 'sire_id',
       'dam_name', 'dam_id', 'owner_name', 'owner_id', 'jockey_name',
       'jockey_id', 'trainer_name', 'trainer_id', 'headgear', 'horse_age',
       'horse_weight', 'jockey_claim', 'draw', 'official_rating', 'course_id',
       'course_name', 'course', 'race_date', 'race_id', 'race_timestamp',
       'first_place_prize_money', 'number_of_runners', 'going', 'distance',
       'race_title', 'race_class', 'conditions', 'surface', 'race_time',
       'horse_price', 'finishing_position', 'rpr_value', 'debug_link',
       'total_distance_beaten', 'ts_value', 'total_prize_money', 'currency',
       'winning_time', 'dams_sire_id', 'extra_weight', 'dams_sire', 'comment',
       'country', 'created_at', 'unique_id', 'meeting_id', 'distance_full'],
      dtype='object')
2024-06-07T05:51:25Z | INFO - Data Sample          horse_name  ... distance_full
0  Ready Freddie Go  ...           NaN
1       Tatterstall  ...           NaN
2      Another Baar  ...           NaN
3            Castan  ...           NaN
4            Khabib  ...           NaN
5          Vadamiah  ...           NaN
6    Le Beau Garcon  ...           NaN
7       Jojo Rabbit  ...           NaN
8    Ecclesiastical  ...           NaN
9          Albegone  ...           NaN

[10 rows x 52 columns]
2024-06-07T05:51:25Z | INFO - Data Sample         race_timestamp  ...                 created_at
10 2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
5  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
0  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
1  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
3  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
4  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
2  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
6  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
7  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
8  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210

[10 rows x 52 columns]
2024-06-07T05:51:25Z | INFO - Validating data...
2024-06-07T05:51:25Z | INFO - Data validated successfully
2024-06-07T05:51:25Z | INFO - Sorting data...
2024-06-07T05:51:25Z | INFO - Data Columns Index(['race_timestamp', 'race_date', 'course_name', 'race_class',
       'horse_name', 'horse_type', 'horse_age', 'headgear', 'conditions',
       'horse_price', 'race_title', 'distance', 'distance_full', 'going',
       'number_of_runners', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'official_rating', 'horse_weight', 'draw', 'country',
       'surface', 'finishing_position', 'total_distance_beaten', 'ts_value',
       'rpr_value', 'extra_weight', 'comment', 'race_time', 'currency',
       'course', 'jockey_name', 'jockey_claim', 'trainer_name', 'sire_name',
       'dam_name', 'dams_sire', 'owner_name', 'horse_id', 'trainer_id',
       'jockey_id', 'sire_id', 'dam_id', 'dams_sire_id', 'owner_id', 'race_id',
       'course_id', 'meeting_id', 'unique_id', 'debug_link', 'created_at'],
      dtype='object')
2024-06-07T05:51:25Z | INFO - Data Sample         race_timestamp  ...                 created_at
10 2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
5  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
0  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
1  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
3  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
4  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
2  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
6  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
7  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
8  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210

[10 rows x 52 columns]
2024-06-07T05:51:25Z | INFO - Data Sample         race_timestamp  ...                 created_at
10 2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
2  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
5  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
9  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
7  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
6  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
8  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
4  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
3  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210
1  2024-06-08 17:00:00  ... 2024-06-07 05:51:25.218210

[10 rows x 52 columns]
2024-06-07T05:51:25Z | INFO - Fetching data with query: SELECT * FROM rp_raw.todays_performance_data
2024-06-07T05:51:25Z | INFO - Truncating rp_raw.todays_performance_data
2024-06-07T05:51:25Z | INFO - Executing query: TRUNCATE TABLE rp_raw.todays_performance_data
2024-06-07T05:51:25Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:51:25Z | INFO - Storing 1238 records in rp_raw.todays_performance_data
2024-06-07T05:51:27Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_todays_rp_data'
2024-06-07T05:51:27Z | INFO - Query executed. Number of rows affected: 1
['https://www.racingpost.com/racecards/10/catterick/2024-06-08/868031', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/868032', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/868033', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/868034', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/868035', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/868036', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/868037', 'https://www.racingpost.com/racecards/10/catterick/2024-06-08/870637', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868038', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868039', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868040', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868041', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868042', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868043', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/868044', 'https://www.racingpost.com/racecards/12/chepstow/2024-06-08/870636', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870170', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870171', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870172', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870173', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870174', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870175', 'https://www.racingpost.com/racecards/193/navan/2024-06-08/870176', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870153', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870154', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870155', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870156', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870157', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870158', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870159', 'https://www.racingpost.com/racecards/195/punchestown/2024-06-08/870634', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867991', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867992', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867993', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867994', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867995', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867996', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/867997', 'https://www.racingpost.com/racecards/23/haydock/2024-06-08/870635', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868045', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868046', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868047', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868048', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868049', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868050', 'https://www.racingpost.com/racecards/31/lingfield/2024-06-08/868051', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867869', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867870', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867871', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867872', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867873', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867874', 'https://www.racingpost.com/racecards/4/bangor-on-dee/2024-06-08/867875', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868024', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868025', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868026', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868027', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868028', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868029', 'https://www.racingpost.com/racecards/6/beverley/2024-06-08/868030']
2024-06-07T05:51:28Z | INFO - Betfair login successful
2024-06-07T05:51:28Z | INFO - Found 82 markets
2024-06-07T05:51:37Z | INFO - Truncating bf_raw.todays_price_data
2024-06-07T05:51:37Z | INFO - Executing query: TRUNCATE TABLE bf_raw.todays_price_data
2024-06-07T05:51:37Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:51:37Z | INFO - Storing 410 records in bf_raw.todays_price_data
2024-06-07T05:51:37Z | INFO - Checking for missing data...
2024-06-07T05:51:37Z | INFO - Fetching data with query: 
        SELECT * 
        FROM errors.missing_todays_races 
        WHERE both_sets = false;
        
2024-06-07T05:51:37Z | INFO - Loading direct matches
2024-06-07T05:51:37Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_sires;
2024-06-07T05:51:37Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_dams;
2024-06-07T05:51:37Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_horses;
2024-06-07T05:51:37Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_jockeys;
2024-06-07T05:51:43Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_trainers;
2024-06-07T05:51:44Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_owners;
2024-06-07T05:51:50Z | INFO - Fetching data with query: SELECT * FROM public.owner
2024-06-07T05:51:50Z | INFO - Storing 12 records in public.owner
/Users/tom.wattley/Code/Projects/racing-api-project/racing-etl/src/pipelines/matching_pipeline.py:96: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  rp_matching_data = pd.concat(
2024-06-07T05:51:50Z | INFO - Fetching data with query: 
        SELECT pd.horse_name,
            pd.horse_id,
            pd.horse_age,
            pd.jockey_id,
            pd.jockey_name,
            pd.trainer_id,
            pd.trainer_name,
            pd.sire_name,
            pd.sire_id,
            pd.dam_name,
            pd.dam_id,
            pd.race_timestamp,
            pd.unique_id,
            pd.race_date,
            pd.debug_link,
            c.id AS course_id
        FROM tf_raw.performance_data pd
        LEFT JOIN public.course c 
        ON pd.course_id = c.tf_id
        WHERE pd.race_date 
        IN ('2024-06-08')
        
2024-06-07T05:51:50Z | INFO - Fetching data with query: 
        SELECT pd.horse_name,
            pd.horse_id,
            pd.horse_age,
            pd.jockey_id,
            pd.jockey_name,
            pd.trainer_id,
            pd.trainer_name,
            pd.sire_name,
            pd.sire_id,
            pd.dam_name,
            pd.dam_id,
            pd.race_timestamp,
            pd.unique_id,
            pd.race_date,
            pd.debug_link,
            c.id AS course_id
        FROM tf_raw.todays_performance_data pd
        LEFT JOIN public.course c 
        ON pd.course_id = c.tf_id
        WHERE pd.race_date 
        IN ('2024-06-08')
        
/Users/tom.wattley/Code/Projects/racing-api-project/racing-etl/src/pipelines/matching_pipeline.py:123: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  tf_matching_data = pd.concat([tf_hist_data, tf_present_data]).drop_duplicates(
2024-06-07T05:51:50Z | INFO - Loading matching data for 14 dates
2024-06-07T05:51:50Z | INFO - Found 673 records for dates :['2024-06-08']
2024-06-07T05:51:50Z | INFO - Missing entities: ['dam' 'horse' 'jockey']
2024-06-07T05:51:50Z | INFO - Matching Fannyjul
2024-06-07T05:51:51Z | INFO - Found match for Fannyjul
2024-06-07T05:51:51Z | INFO - Matching La La Loopsey
2024-06-07T05:51:51Z | INFO - Found match for La La Loopsey
2024-06-07T05:51:51Z | INFO - Matching Implicit
2024-06-07T05:51:51Z | INFO - Found match for Implicit
2024-06-07T05:51:51Z | INFO - Matching Taras Rainbow
2024-06-07T05:51:51Z | INFO - Found match for Taras Rainbow
2024-06-07T05:51:51Z | INFO - Matching Beauty Of Night
2024-06-07T05:51:51Z | INFO - Found match for Beauty Of Night
2024-06-07T05:51:51Z | INFO - Matching Ringadingadoo
2024-06-07T05:51:51Z | INFO - Found match for Ringadingadoo
2024-06-07T05:51:51Z | INFO - Matching Hurricanes Girl
2024-06-07T05:51:51Z | INFO - Found match for Hurricanes Girl
2024-06-07T05:51:51Z | INFO - Matching Queensbrydge
2024-06-07T05:51:51Z | INFO - Found match for Queensbrydge
2024-06-07T05:51:51Z | INFO - Matching Flawlessly
2024-06-07T05:51:51Z | INFO - Found match for Flawlessly
2024-06-07T05:51:51Z | INFO - Matching Ty Rock Brandy
2024-06-07T05:51:51Z | INFO - Found match for Ty Rock Brandy
2024-06-07T05:51:51Z | INFO - Matching Ambers Rose
2024-06-07T05:51:51Z | INFO - Found match for Ambers Rose
2024-06-07T05:51:51Z | INFO - Matching Bayadere
2024-06-07T05:51:51Z | INFO - Found match for Bayadere
2024-06-07T05:51:51Z | INFO - Matching Caminito Del Rey
2024-06-07T05:51:51Z | INFO - Found match for Caminito Del Rey
2024-06-07T05:51:51Z | INFO - Matching Celtic Chieftain
2024-06-07T05:51:51Z | INFO - Found match for Celtic Chieftain
2024-06-07T05:51:51Z | INFO - Matching El Toro Rocco
2024-06-07T05:51:51Z | INFO - Found match for El Toro Rocco
2024-06-07T05:51:51Z | INFO - Matching Elmonir
2024-06-07T05:51:51Z | INFO - Found match for Elmonir
2024-06-07T05:51:51Z | INFO - Matching Eponine Etoile
2024-06-07T05:51:51Z | INFO - Found match for Eponine Etoile
2024-06-07T05:51:51Z | INFO - Matching Fan Magnet
2024-06-07T05:51:51Z | INFO - Found match for Fan Magnet
2024-06-07T05:51:51Z | INFO - Matching Final Flutter
2024-06-07T05:51:51Z | INFO - Found match for Final Flutter
2024-06-07T05:51:51Z | INFO - Matching Flying Phoenix
2024-06-07T05:51:51Z | INFO - Found match for Flying Phoenix
2024-06-07T05:51:51Z | INFO - Matching Glamorous Jewel
2024-06-07T05:51:51Z | INFO - Found match for Glamorous Jewel
2024-06-07T05:51:51Z | INFO - Matching Hakensack
2024-06-07T05:51:51Z | INFO - Found match for Hakensack
2024-06-07T05:51:51Z | INFO - Matching Handy Manny
2024-06-07T05:51:51Z | INFO - Found match for Handy Manny
2024-06-07T05:51:51Z | INFO - Matching Havana White
2024-06-07T05:51:51Z | INFO - Found match for Havana White
2024-06-07T05:51:51Z | INFO - Matching Horus
2024-06-07T05:51:51Z | INFO - Found match for Horus
2024-06-07T05:51:51Z | INFO - Matching I Spy A Rainbow
2024-06-07T05:51:51Z | INFO - Found match for I Spy A Rainbow
2024-06-07T05:51:51Z | INFO - Matching Jersey Klass
2024-06-07T05:51:51Z | INFO - Found match for Jersey Klass
2024-06-07T05:51:51Z | INFO - Matching Joecooker
2024-06-07T05:51:51Z | INFO - Found match for Joecooker
2024-06-07T05:51:51Z | INFO - Matching Kodiac Brave
2024-06-07T05:51:52Z | INFO - Found match for Kodiac Brave
2024-06-07T05:51:52Z | INFO - Matching La Vita Nova
2024-06-07T05:51:52Z | INFO - Found match for La Vita Nova
2024-06-07T05:51:52Z | INFO - Matching Little Beast
2024-06-07T05:51:52Z | INFO - Found match for Little Beast
2024-06-07T05:51:52Z | INFO - Matching Miami Memories
2024-06-07T05:51:52Z | INFO - Found match for Miami Memories
2024-06-07T05:51:52Z | INFO - Matching Mighty Soldier
2024-06-07T05:51:52Z | INFO - Found match for Mighty Soldier
2024-06-07T05:51:52Z | INFO - Matching Mountain Port
2024-06-07T05:51:52Z | INFO - Found match for Mountain Port
2024-06-07T05:51:52Z | INFO - Matching On A Sticky Wicket
2024-06-07T05:51:52Z | INFO - Found match for On A Sticky Wicket
2024-06-07T05:51:52Z | INFO - Matching Perfect Part
2024-06-07T05:51:52Z | INFO - Found match for Perfect Part
2024-06-07T05:51:52Z | INFO - Matching Rumba Bay
2024-06-07T05:51:52Z | INFO - Found match for Rumba Bay
2024-06-07T05:51:52Z | INFO - Matching Sense Of Spirit
2024-06-07T05:51:52Z | INFO - Found match for Sense Of Spirit
2024-06-07T05:51:52Z | INFO - Matching Shareholder
2024-06-07T05:51:52Z | INFO - Found match for Shareholder
2024-06-07T05:51:52Z | INFO - Matching Tillys Company
2024-06-07T05:51:52Z | INFO - Found match for Tillys Company
2024-06-07T05:51:52Z | INFO - Matching Tino Pai
2024-06-07T05:51:52Z | INFO - Found match for Tino Pai
2024-06-07T05:51:52Z | INFO - Matching Urs Fischer
2024-06-07T05:51:52Z | INFO - Found match for Urs Fischer
2024-06-07T05:51:52Z | INFO - Matching Wee Mary
2024-06-07T05:51:52Z | INFO - Found match for Wee Mary
2024-06-07T05:51:52Z | INFO - Matching Work De Street
2024-06-07T05:51:52Z | INFO - Found match for Work De Street
2024-06-07T05:51:52Z | INFO - Matching Mr G Daly
2024-06-07T05:51:52Z | INFO - Found match for Mr G Daly
2024-06-07T05:51:52Z | INFO - Matching Zoe Lewis
2024-06-07T05:51:52Z | INFO - Found match for Zoe Lewis
2024-06-07T05:51:52Z | INFO - Matching Dylan White
2024-06-07T05:51:52Z | INFO - Found match for Dylan White
2024-06-07T05:51:52Z | INFO - Matching Shay Farmer
2024-06-07T05:51:52Z | INFO - Found match for Shay Farmer
2024-06-07T05:51:52Z | INFO - Fetching data with query: SELECT * FROM public.horse
2024-06-07T05:51:52Z | INFO - Fetching data with query: SELECT * FROM public.sire
2024-06-07T05:51:52Z | INFO - Fetching data with query: SELECT * FROM public.dam
2024-06-07T05:51:52Z | INFO - Fetching data with query: SELECT * FROM public.jockey
2024-06-07T05:51:52Z | INFO - Fetching data with query: SELECT * FROM public.trainer
2024-06-07T05:51:53Z | INFO - No data to store in public.sire
2024-06-07T05:51:53Z | INFO - No data to store in public.trainer
2024-06-07T05:51:53Z | INFO - Storing 4 records in public.jockey
2024-06-07T05:51:53Z | INFO - Storing 10 records in public.dam
2024-06-07T05:51:53Z | INFO - Storing 34 records in public.horse
2024-06-07T05:51:53Z | INFO - Calling stored procedure staging.insert_into_joined_performance_data()
2024-06-07T05:51:53Z | INFO - Calling stored procedure staging.insert_into_todays_joined_performance_data()
2024-06-07T05:52:04Z | INFO - Stored procedure staging.insert_into_joined_performance_data() completed
2024-06-07T05:52:46Z | INFO - Stored procedure staging.insert_into_todays_joined_performance_data() completed
2024-06-07T05:52:46Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM rp_raw.todays_performance_data;
2024-06-07T05:52:46Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM staging.todays_joined_performance_data;
2024-06-07T05:52:46Z | INFO - SUCCESS: RAW: 1238 STAGING: 1238
2024-06-07T05:52:46Z | INFO - Starting Betfair matching
2024-06-07T05:52:46Z | INFO - Fetching data with query: 
                    SELECT race_timestamp, h.id, horse_name 
                    FROM rp_raw.todays_performance_data tpd
                    LEFT JOIN horse h
                    ON tpd.horse_id = h.rp_id
            
2024-06-07T05:52:46Z | INFO - Fetching data with query: SELECT race_time, horse_id, horse_name FROM bf_raw.todays_price_data
2024-06-07T05:52:47Z | INFO - Matched 410 of 410 horses
2024-06-07T05:52:47Z | INFO - Truncating public.bf_horse
2024-06-07T05:52:47Z | INFO - Executing query: TRUNCATE TABLE public.bf_horse
2024-06-07T05:52:47Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:52:47Z | INFO - Storing 410 records in public.bf_horse
2024-06-07T05:52:47Z | INFO - Fetching data with query: SELECT * FROM public.missing_performance_data_vw;
2024-06-07T05:52:47Z | INFO - Fetching data with query: SELECT * FROM public.missing_todays_performance_data_vw;
2024-06-07T05:52:47Z | INFO - Mapping race time column
2024-06-07T05:52:47Z | INFO - Creating pounds
2024-06-07T05:52:47Z | INFO - Creating distance data
2024-06-07T05:52:47Z | INFO - Creating headgear data
2024-06-07T05:52:47Z | INFO - Cleaning race class field
2024-06-07T05:52:47Z | INFO - Converting horse type to colour and sex
2024-06-07T05:52:47Z | INFO - Converting data...
2024-06-07T05:52:47Z | INFO - Data converted successfully
2024-06-07T05:52:47Z | INFO - Sorting data...
2024-06-07T05:52:47Z | INFO - Data Columns Index(['horse_name', 'horse_age', 'jockey_name', 'jockey_claim',
       'trainer_name', 'owner_name', 'weight_carried', 'draw',
       'finishing_position', 'total_distance_beaten', 'age', 'official_rating',
       'ts', 'rpr', 'industry_sp', 'extra_weight', 'headgear',
       'in_race_comment', 'sire_name', 'dam_name', 'dams_sire', 'race_date',
       'race_title', 'race_time_original', 'race_time', 'race_class',
       'conditions', 'distance', 'going', 'winning_time', 'number_of_runners',
       'total_prize_money', 'first_place_prize_money', 'currency', 'country',
       'surface', 'tfr', 'tfig', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'hcap_range', 'age_range', 'race_type',
       'main_race_comment', 'meeting_id', 'course_id', 'horse_id', 'sire_id',
       'dam_id', 'trainer_id', 'jockey_id', 'owner_id', 'race_id', 'unique_id',
       'created_at', 'data_type', 'tfr_view', 'weight_carried_st',
       'weight_carried_extra_lbs', 'weight_carried_lbs', 'in_play_low',
       'in_play_high', 'distance_yards', 'distance_meters',
       'distance_kilometers', 'time_seconds', 'relative_to_standard',
       'relative_time', 'horse_colour', 'horse_sex'],
      dtype='object')
2024-06-07T05:52:47Z | INFO - Data Sample         horse_name horse_age  ... horse_colour horse_sex
0  The Miracle Man         6  ...          Bay   Gelding
1       Ragga Bomb         3  ...          Bay   Gelding
2          Sawbuck         6  ...     Chestnut   Gelding
3          Gaucher         5  ...     Chestnut   Gelding
4           Miguel         3  ...     Chestnut   Gelding
5        Kudasheva         6  ...          Bay      Mare
6    Shining Aitch         7  ...         Grey   Gelding
7   Flashthelights         8  ...          Bay   Gelding
8        Ginormous         3  ...          Bay   Gelding
9      Jm Jhingree         2  ...          Bay   Gelding

[10 rows x 72 columns]
2024-06-07T05:52:47Z | INFO - Data Sample               race_time  ...                 created_at
0   2024-06-08 16:17:00  ... 2024-06-07 05:51:53.428605
823 2024-06-08 20:15:00  ... 2024-06-07 05:51:53.428605
830 2024-06-08 20:00:00  ... 2024-06-07 05:51:53.428605
829 2024-06-08 19:45:00  ... 2024-06-07 05:51:53.428605
828 2024-06-07 16:40:00  ... 2024-06-07 05:51:53.428605
827 2024-06-08 16:17:00  ... 2024-06-07 05:51:53.428605
826 2024-06-07 19:05:00  ... 2024-06-07 05:51:53.428605
825 2024-06-08 13:45:00  ... 2024-06-07 05:51:53.428605
824 2024-06-08 20:15:00  ... 2024-06-07 05:51:53.428605
822 2024-06-07 18:15:00  ... 2024-06-07 05:51:53.428605

[10 rows x 36 columns]
2024-06-07T05:52:47Z | INFO - Validating data...
2024-06-07T05:52:47Z | INFO - Data validated successfully
2024-06-07T05:52:47Z | INFO - Sorting data...
2024-06-07T05:52:47Z | INFO - Data Columns Index(['race_time', 'race_date', 'horse_name', 'age', 'horse_sex', 'draw',
       'headgear', 'weight_carried', 'weight_carried_lbs', 'extra_weight',
       'jockey_claim', 'finishing_position', 'total_distance_beaten',
       'industry_sp', 'betfair_win_sp', 'betfair_place_sp', 'official_rating',
       'ts', 'rpr', 'tfig', 'tfr', 'in_play_high', 'in_play_low',
       'in_race_comment', 'tf_comment', 'tfr_view', 'race_id', 'course_id',
       'horse_id', 'jockey_id', 'trainer_id', 'owner_id', 'sire_id', 'dam_id',
       'unique_id', 'created_at'],
      dtype='object')
2024-06-07T05:52:47Z | INFO - Data Sample               race_time  ...                 created_at
0   2024-06-08 16:17:00  ... 2024-06-07 05:51:53.428605
823 2024-06-08 20:15:00  ... 2024-06-07 05:51:53.428605
830 2024-06-08 20:00:00  ... 2024-06-07 05:51:53.428605
829 2024-06-08 19:45:00  ... 2024-06-07 05:51:53.428605
828 2024-06-07 16:40:00  ... 2024-06-07 05:51:53.428605
827 2024-06-08 16:17:00  ... 2024-06-07 05:51:53.428605
826 2024-06-07 19:05:00  ... 2024-06-07 05:51:53.428605
825 2024-06-08 13:45:00  ... 2024-06-07 05:51:53.428605
824 2024-06-08 20:15:00  ... 2024-06-07 05:51:53.428605
822 2024-06-07 18:15:00  ... 2024-06-07 05:51:53.428605

[10 rows x 36 columns]
2024-06-07T05:52:48Z | INFO - Data Sample              race_time  ...                 created_at
0  2024-06-08 16:17:00  ... 2024-06-07 05:51:53.428605
9  2024-06-08 14:40:00  ... 2024-06-07 05:51:53.428605
3  2024-06-08 15:07:00  ... 2024-06-07 05:51:53.428605
4  2024-06-08 16:10:00  ... 2024-06-07 05:51:53.428605
5  2024-06-07 19:55:00  ... 2024-06-07 05:51:53.428605
6  2024-06-08 17:15:00  ... 2024-06-07 05:51:53.428605
7  2024-06-08 16:52:00  ... 2024-06-07 05:51:53.428605
8  2024-06-08 14:55:00  ... 2024-06-07 05:51:53.428605
37 2024-06-08 15:42:00  ... 2024-06-07 05:51:53.428605
11 2024-06-08 17:40:00  ... 2024-06-07 05:51:53.428605

[10 rows x 36 columns]
2024-06-07T05:52:48Z | INFO - Converting data...
2024-06-07T05:52:48Z | INFO - Data converted successfully
2024-06-07T05:52:48Z | INFO - Sorting data...
2024-06-07T05:52:48Z | INFO - Data Columns Index(['horse_name', 'horse_age', 'jockey_name', 'jockey_claim',
       'trainer_name', 'owner_name', 'weight_carried', 'draw',
       'finishing_position', 'total_distance_beaten', 'age', 'official_rating',
       'ts', 'rpr', 'industry_sp', 'extra_weight', 'headgear',
       'in_race_comment', 'sire_name', 'dam_name', 'dams_sire', 'race_date',
       'race_title', 'race_time_original', 'race_time', 'race_class',
       'conditions', 'distance', 'going', 'winning_time', 'number_of_runners',
       'total_prize_money', 'first_place_prize_money', 'currency', 'country',
       'surface', 'tfr', 'tfig', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'hcap_range', 'age_range', 'race_type',
       'main_race_comment', 'meeting_id', 'course_id', 'horse_id', 'sire_id',
       'dam_id', 'trainer_id', 'jockey_id', 'owner_id', 'race_id', 'unique_id',
       'created_at', 'data_type', 'tfr_view', 'weight_carried_st',
       'weight_carried_extra_lbs', 'weight_carried_lbs', 'in_play_low',
       'in_play_high', 'distance_yards', 'distance_meters',
       'distance_kilometers', 'time_seconds', 'relative_to_standard',
       'relative_time', 'horse_colour', 'horse_sex'],
      dtype='object')
2024-06-07T05:52:48Z | INFO - Data Sample         horse_name horse_age  ... horse_colour horse_sex
0  The Miracle Man         6  ...          Bay   Gelding
1       Ragga Bomb         3  ...          Bay   Gelding
2          Sawbuck         6  ...     Chestnut   Gelding
3          Gaucher         5  ...     Chestnut   Gelding
4           Miguel         3  ...     Chestnut   Gelding
5        Kudasheva         6  ...          Bay      Mare
6    Shining Aitch         7  ...         Grey   Gelding
7   Flashthelights         8  ...          Bay   Gelding
8        Ginormous         3  ...          Bay   Gelding
9      Jm Jhingree         2  ...          Bay   Gelding

[10 rows x 72 columns]
2024-06-07T05:52:48Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-08 16:17:00  2024-06-08  ...        65 2024-06-07 05:51:53.428605
823 2024-06-08 20:15:00  2024-06-08  ...        48 2024-06-07 05:51:53.428605
830 2024-06-08 20:00:00  2024-06-08  ...        15 2024-06-07 05:51:53.428605
829 2024-06-08 19:45:00  2024-06-08  ...        48 2024-06-07 05:51:53.428605
828 2024-06-07 16:40:00  2024-06-07  ...        77 2024-06-07 05:51:53.428605
826 2024-06-07 19:05:00  2024-06-07  ...        31 2024-06-07 05:51:53.428605
825 2024-06-08 13:45:00  2024-06-08  ...        54 2024-06-07 05:51:53.428605
822 2024-06-07 18:15:00  2024-06-07  ...         6 2024-06-07 05:51:53.428605
813 2024-06-08 14:05:00  2024-06-08  ...         8 2024-06-07 05:51:53.428605
821 2024-06-08 14:55:00  2024-06-08  ...        54 2024-06-07 05:51:53.428605

[10 rows x 27 columns]
2024-06-07T05:52:48Z | INFO - Validating data...
2024-06-07T05:52:48Z | INFO - Data validated successfully
2024-06-07T05:52:48Z | INFO - Sorting data...
2024-06-07T05:52:48Z | INFO - Data Columns Index(['race_time', 'race_date', 'race_title', 'race_type', 'race_class',
       'distance', 'distance_yards', 'distance_meters', 'distance_kilometers',
       'conditions', 'going', 'number_of_runners', 'hcap_range', 'age_range',
       'surface', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'time_seconds', 'relative_time', 'relative_to_standard',
       'country', 'main_race_comment', 'meeting_id', 'race_id', 'course_id',
       'created_at'],
      dtype='object')
2024-06-07T05:52:48Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-08 16:17:00  2024-06-08  ...        65 2024-06-07 05:51:53.428605
823 2024-06-08 20:15:00  2024-06-08  ...        48 2024-06-07 05:51:53.428605
830 2024-06-08 20:00:00  2024-06-08  ...        15 2024-06-07 05:51:53.428605
829 2024-06-08 19:45:00  2024-06-08  ...        48 2024-06-07 05:51:53.428605
828 2024-06-07 16:40:00  2024-06-07  ...        77 2024-06-07 05:51:53.428605
826 2024-06-07 19:05:00  2024-06-07  ...        31 2024-06-07 05:51:53.428605
825 2024-06-08 13:45:00  2024-06-08  ...        54 2024-06-07 05:51:53.428605
822 2024-06-07 18:15:00  2024-06-07  ...         6 2024-06-07 05:51:53.428605
813 2024-06-08 14:05:00  2024-06-08  ...         8 2024-06-07 05:51:53.428605
821 2024-06-08 14:55:00  2024-06-08  ...        54 2024-06-07 05:51:53.428605

[10 rows x 27 columns]
2024-06-07T05:52:48Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-08 16:17:00  2024-06-08  ...        65 2024-06-07 05:51:53.428605
857 2024-06-07 15:18:00  2024-06-07  ...        51 2024-06-07 05:51:53.428605
670 2024-06-07 19:35:00  2024-06-07  ...        31 2024-06-07 05:51:53.428605
673 2024-06-08 17:52:00  2024-06-08  ...        34 2024-06-07 05:51:53.428605
668 2024-06-07 18:28:00  2024-06-07  ...        34 2024-06-07 05:51:53.428605
875 2024-06-08 14:32:00  2024-06-08  ...        65 2024-06-07 05:51:53.428605
877 2024-06-08 17:05:00  2024-06-08  ...        12 2024-06-07 05:51:53.428605
880 2024-06-07 16:35:00  2024-06-07  ...        26 2024-06-07 05:51:53.428605
881 2024-06-07 15:30:00  2024-06-07  ...         9 2024-06-07 05:51:53.428605
882 2024-06-08 18:15:00  2024-06-08  ...        48 2024-06-07 05:51:53.428605

[10 rows x 27 columns]
2024-06-07T05:52:48Z | INFO - No data to store in errors.staging_todays_transformed_performance_data_rejected
2024-06-07T05:52:48Z | INFO - Truncating staging.todays_transformed_performance_data
2024-06-07T05:52:48Z | INFO - Executing query: TRUNCATE TABLE staging.todays_transformed_performance_data
2024-06-07T05:52:48Z | INFO - Truncating staging.todays_transformed_race_data
2024-06-07T05:52:48Z | INFO - Executing query: TRUNCATE TABLE staging.todays_transformed_race_data
2024-06-07T05:52:48Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:52:48Z | INFO - Storing 1238 records in staging.todays_transformed_performance_data
2024-06-07T05:52:48Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:52:48Z | INFO - Storing 116 records in staging.todays_transformed_race_data
2024-06-07T05:52:59Z | INFO - Mapping race time column
2024-06-07T05:52:59Z | INFO - Getting surfaces from tf rating
2024-06-07T05:52:59Z | INFO - Getting tf rating values
2024-06-07T05:52:59Z | INFO - Creating pounds
2024-06-07T05:52:59Z | INFO - Getting inplay high and low
2024-06-07T05:52:59Z | INFO - Creating distance data
2024-06-07T05:52:59Z | INFO - Creating time data
2024-06-07T05:52:59Z | INFO - Creating headgear data
2024-06-07T05:52:59Z | INFO - Converting tf rating
2024-06-07T05:52:59Z | INFO - Cleaning race class field
2024-06-07T05:52:59Z | INFO - Converting horse type to colour and sex
2024-06-07T05:52:59Z | INFO - Creating distance beaten data
2024-06-07T05:52:59Z | INFO - Converting data...
2024-06-07T05:52:59Z | INFO - Data converted successfully
2024-06-07T05:52:59Z | INFO - Sorting data...
2024-06-07T05:52:59Z | INFO - Data Columns Index(['horse_name', 'horse_age', 'jockey_name', 'jockey_claim',
       'trainer_name', 'owner_name', 'weight_carried', 'draw',
       'finishing_position', 'total_distance_beaten', 'age', 'official_rating',
       'ts', 'rpr', 'industry_sp', 'extra_weight', 'headgear',
       'in_race_comment', 'sire_name', 'dam_name', 'dams_sire', 'race_date',
       'race_title', 'race_time_original', 'race_time', 'race_class',
       'conditions', 'distance', 'going', 'winning_time', 'number_of_runners',
       'total_prize_money', 'first_place_prize_money', 'currency', 'country',
       'surface', 'tfr', 'tfig', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'hcap_range', 'age_range', 'race_type',
       'main_race_comment', 'meeting_id', 'course_id', 'horse_id', 'sire_id',
       'dam_id', 'trainer_id', 'jockey_id', 'owner_id', 'race_id', 'unique_id',
       'created_at', 'data_type', 'tfr_view', 'weight_carried_st',
       'weight_carried_extra_lbs', 'weight_carried_lbs', 'in_play_low',
       'in_play_high', 'distance_yards', 'distance_meters',
       'distance_kilometers', 'time_seconds', 'relative_to_standard',
       'relative_time', 'horse_colour', 'horse_sex',
       'total_distance_beaten_str'],
      dtype='object')
2024-06-07T05:52:59Z | INFO - Data Sample            horse_name horse_age  ... horse_sex total_distance_beaten_str
0   Nights Over Egypt         4  ...   Gelding                      [4]
1            The Wolf        10  ...   Gelding                        1
2  Dillydingdillydong         6  ...   Gelding                      [6]
3     Chase A Fortune         6  ...   Gelding                          
4      Clipsham Noble         2  ...   Gelding                     [26]
5          Irrelevant         3  ...   Gelding                      [7]
6       Greatest Time         4  ...   Gelding                      [9]
7     Nobodys Perfect         5  ...      Mare                      [8]
8             Calyxoh         2  ...   Gelding                      [2]
9           Cyclonite         2  ...      Colt                      [2]

[10 rows x 73 columns]
2024-06-07T05:52:59Z | INFO - Data Sample               race_time  ...                 created_at
0   2024-06-04 18:30:00  ... 2024-06-07 05:51:53.428640
186 2024-06-04 18:45:00  ... 2024-06-07 05:51:53.428640
172 2024-06-04 17:50:00  ... 2024-06-07 05:51:53.428640
173 2024-06-04 14:33:00  ... 2024-06-07 05:51:53.428640
174 2024-06-04 16:50:00  ... 2024-06-07 05:51:53.428640
175 2024-06-04 20:45:00  ... 2024-06-07 05:51:53.428640
176 2024-06-04 15:15:00  ... 2024-06-07 05:51:53.428640
177 2024-06-04 18:00:00  ... 2024-06-07 05:51:53.428640
178 2024-06-04 16:20:00  ... 2024-06-07 05:51:53.428640
179 2024-06-04 21:00:00  ... 2024-06-07 05:51:53.428640

[10 rows x 36 columns]
2024-06-07T05:52:59Z | INFO - Validating data...
2024-06-07T05:52:59Z | INFO - Data validated successfully
2024-06-07T05:52:59Z | INFO - Sorting data...
2024-06-07T05:52:59Z | INFO - Data Columns Index(['race_time', 'race_date', 'horse_name', 'age', 'horse_sex', 'draw',
       'headgear', 'weight_carried', 'weight_carried_lbs', 'extra_weight',
       'jockey_claim', 'finishing_position', 'total_distance_beaten',
       'industry_sp', 'betfair_win_sp', 'betfair_place_sp', 'official_rating',
       'ts', 'rpr', 'tfig', 'tfr', 'in_play_high', 'in_play_low',
       'in_race_comment', 'tf_comment', 'tfr_view', 'race_id', 'course_id',
       'horse_id', 'jockey_id', 'trainer_id', 'owner_id', 'sire_id', 'dam_id',
       'unique_id', 'created_at'],
      dtype='object')
2024-06-07T05:52:59Z | INFO - Data Sample               race_time  ...                 created_at
0   2024-06-04 18:30:00  ... 2024-06-07 05:51:53.428640
186 2024-06-04 18:45:00  ... 2024-06-07 05:51:53.428640
172 2024-06-04 17:50:00  ... 2024-06-07 05:51:53.428640
173 2024-06-04 14:33:00  ... 2024-06-07 05:51:53.428640
174 2024-06-04 16:50:00  ... 2024-06-07 05:51:53.428640
175 2024-06-04 20:45:00  ... 2024-06-07 05:51:53.428640
176 2024-06-04 15:15:00  ... 2024-06-07 05:51:53.428640
177 2024-06-04 18:00:00  ... 2024-06-07 05:51:53.428640
178 2024-06-04 16:20:00  ... 2024-06-07 05:51:53.428640
179 2024-06-04 21:00:00  ... 2024-06-07 05:51:53.428640

[10 rows x 36 columns]
2024-06-07T05:52:59Z | INFO - Data Sample              race_time  ...                 created_at
0  2024-06-04 18:30:00  ... 2024-06-07 05:51:53.428640
17 2024-06-04 20:45:00  ... 2024-06-07 05:51:53.428640
2  2024-06-04 18:00:00  ... 2024-06-07 05:51:53.428640
3  2024-06-04 14:15:00  ... 2024-06-07 05:51:53.428640
4  2024-06-04 18:45:00  ... 2024-06-07 05:51:53.428640
5  2024-06-04 20:15:00  ... 2024-06-07 05:51:53.428640
6  2024-06-04 19:00:00  ... 2024-06-07 05:51:53.428640
7  2024-06-04 15:15:00  ... 2024-06-07 05:51:53.428640
8  2024-06-04 14:33:00  ... 2024-06-07 05:51:53.428640
9  2024-06-04 17:30:00  ... 2024-06-07 05:51:53.428640

[10 rows x 36 columns]
2024-06-07T05:52:59Z | INFO - Converting data...
2024-06-07T05:52:59Z | INFO - Data converted successfully
2024-06-07T05:52:59Z | INFO - Sorting data...
2024-06-07T05:52:59Z | INFO - Data Columns Index(['horse_name', 'horse_age', 'jockey_name', 'jockey_claim',
       'trainer_name', 'owner_name', 'weight_carried', 'draw',
       'finishing_position', 'total_distance_beaten', 'age', 'official_rating',
       'ts', 'rpr', 'industry_sp', 'extra_weight', 'headgear',
       'in_race_comment', 'sire_name', 'dam_name', 'dams_sire', 'race_date',
       'race_title', 'race_time_original', 'race_time', 'race_class',
       'conditions', 'distance', 'going', 'winning_time', 'number_of_runners',
       'total_prize_money', 'first_place_prize_money', 'currency', 'country',
       'surface', 'tfr', 'tfig', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'hcap_range', 'age_range', 'race_type',
       'main_race_comment', 'meeting_id', 'course_id', 'horse_id', 'sire_id',
       'dam_id', 'trainer_id', 'jockey_id', 'owner_id', 'race_id', 'unique_id',
       'created_at', 'data_type', 'tfr_view', 'weight_carried_st',
       'weight_carried_extra_lbs', 'weight_carried_lbs', 'in_play_low',
       'in_play_high', 'distance_yards', 'distance_meters',
       'distance_kilometers', 'time_seconds', 'relative_to_standard',
       'relative_time', 'horse_colour', 'horse_sex',
       'total_distance_beaten_str'],
      dtype='object')
2024-06-07T05:53:00Z | INFO - Data Sample            horse_name horse_age  ... horse_sex total_distance_beaten_str
0   Nights Over Egypt         4  ...   Gelding                      [4]
1            The Wolf        10  ...   Gelding                        1
2  Dillydingdillydong         6  ...   Gelding                      [6]
3     Chase A Fortune         6  ...   Gelding                          
4      Clipsham Noble         2  ...   Gelding                     [26]
5          Irrelevant         3  ...   Gelding                      [7]
6       Greatest Time         4  ...   Gelding                      [9]
7     Nobodys Perfect         5  ...      Mare                      [8]
8             Calyxoh         2  ...   Gelding                      [2]
9           Cyclonite         2  ...      Colt                      [2]

[10 rows x 73 columns]
2024-06-07T05:53:00Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-04 18:30:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
186 2024-06-04 18:45:00  2024-06-04  ...        47 2024-06-07 05:51:53.428640
172 2024-06-04 17:50:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
173 2024-06-04 14:33:00  2024-06-04  ...        44 2024-06-07 05:51:53.428640
174 2024-06-04 16:50:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
175 2024-06-04 20:45:00  2024-06-04  ...        47 2024-06-07 05:51:53.428640
176 2024-06-04 15:15:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
177 2024-06-04 18:00:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
178 2024-06-04 16:20:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
179 2024-06-04 21:00:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640

[10 rows x 27 columns]
2024-06-07T05:53:00Z | INFO - Validating data...
2024-06-07T05:53:00Z | INFO - Data validated successfully
2024-06-07T05:53:00Z | INFO - Sorting data...
2024-06-07T05:53:00Z | INFO - Data Columns Index(['race_time', 'race_date', 'race_title', 'race_type', 'race_class',
       'distance', 'distance_yards', 'distance_meters', 'distance_kilometers',
       'conditions', 'going', 'number_of_runners', 'hcap_range', 'age_range',
       'surface', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'time_seconds', 'relative_time', 'relative_to_standard',
       'country', 'main_race_comment', 'meeting_id', 'race_id', 'course_id',
       'created_at'],
      dtype='object')
2024-06-07T05:53:00Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-04 18:30:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
186 2024-06-04 18:45:00  2024-06-04  ...        47 2024-06-07 05:51:53.428640
172 2024-06-04 17:50:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
173 2024-06-04 14:33:00  2024-06-04  ...        44 2024-06-07 05:51:53.428640
174 2024-06-04 16:50:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
175 2024-06-04 20:45:00  2024-06-04  ...        47 2024-06-07 05:51:53.428640
176 2024-06-04 15:15:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
177 2024-06-04 18:00:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
178 2024-06-04 16:20:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
179 2024-06-04 21:00:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640

[10 rows x 27 columns]
2024-06-07T05:53:00Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-04 18:30:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
186 2024-06-04 18:45:00  2024-06-04  ...        47 2024-06-07 05:51:53.428640
248 2024-06-04 17:20:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
163 2024-06-04 18:15:00  2024-06-04  ...        47 2024-06-07 05:51:53.428640
146 2024-06-04 15:45:00  2024-06-04  ...        74 2024-06-07 05:51:53.428640
140 2024-06-04 17:30:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
203 2024-06-04 19:30:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
169 2024-06-04 15:03:00  2024-06-04  ...        44 2024-06-07 05:51:53.428640
200 2024-06-04 20:30:00  2024-06-04  ...        89 2024-06-07 05:51:53.428640
199 2024-06-04 16:38:00  2024-06-04  ...        44 2024-06-07 05:51:53.428640

[10 rows x 27 columns]
2024-06-07T05:53:00Z | INFO - No data to store in errors.staging_transformed_performance_data_rejected
2024-06-07T05:53:00Z | INFO - Truncating staging.transformed_performance_data
2024-06-07T05:53:00Z | INFO - Truncating staging.transformed_race_data
2024-06-07T05:53:00Z | INFO - Executing query: TRUNCATE TABLE staging.transformed_performance_data
2024-06-07T05:53:00Z | INFO - Executing query: TRUNCATE TABLE staging.transformed_race_data
2024-06-07T05:53:00Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:53:00Z | INFO - Query executed. Number of rows affected: -1
2024-06-07T05:53:00Z | INFO - Storing 271 records in staging.transformed_performance_data
2024-06-07T05:53:00Z | INFO - Storing 28 records in staging.transformed_race_data
2024-06-07T05:53:00Z | INFO - Calling stored procedure public.insert_transformed_performance_data()
2024-06-07T05:53:00Z | INFO - Calling stored procedure public.insert_transformed_race_data()
2024-06-07T05:53:00Z | INFO - Calling stored procedure public.insert_todays_transformed_performance_data()
2024-06-07T05:53:00Z | INFO - Calling stored procedure public.insert_todays_transformed_race_data()
2024-06-07T05:53:00Z | INFO - Stored procedure public.insert_transformed_race_data() completed
2024-06-07T05:53:00Z | INFO - Stored procedure public.insert_todays_transformed_race_data() completed
2024-06-07T05:53:00Z | INFO - Stored procedure public.insert_todays_transformed_performance_data() completed
2024-06-07T05:53:01Z | INFO - Stored procedure public.insert_transformed_performance_data() completed
2024-06-07T05:53:01Z | INFO - Running post-transform checks
2024-06-07T05:53:01Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM staging.todays_joined_performance_data;
2024-06-07T05:53:01Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM public.todays_performance_data;
2024-06-07T05:53:01Z | INFO - SUCCESS: STAGING: 1238 DATA: 1238
2024-06-07T05:53:01Z | INFO - Calling stored procedure public.insert_unioned_performance_data()
2024-06-07T05:54:45Z | INFO - Stored procedure public.insert_unioned_performance_data() completed
2024-06-07T05:54:45Z | INFO - Fetching data with query: SELECT * FROM metrics.record_count_differences_vw
2024-06-07T05:54:45Z | INFO - Fetching data with query: SELECT * FROM metrics.missing_raw_data
2024-06-07T05:55:45Z | INFO - No missing data between RP and TF
2024-06-07T05:55:45Z | INFO - No missing data in final performance data table

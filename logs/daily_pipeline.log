2024-07-02T10:56:28Z | INFO - Running historical pipeline
2024-07-02T10:56:28Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-07-02T10:56:28Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-07-02T10:56:28Z | INFO - Creating a new WebDriver with headless mode set to True
2024-07-02T10:56:28Z | INFO - Creating a new WebDriver with headless mode set to True
2024-07-02T10:56:29Z | INFO - Scrape_links.py execution started.
2024-07-02T10:56:29Z | INFO - Scrape_links.py execution started.
2024-07-02T10:56:29Z | INFO - Fetching data with query: SELECT * FROM tf_raw.missing_dates
2024-07-02T10:56:29Z | INFO - Fetching data with query: SELECT * FROM rp_raw.missing_dates
2024-07-02T10:56:29Z | INFO - Generated URL for scraping: https://www.racingpost.com/results/2024-06-29
2024-07-02T10:56:29Z | INFO - Generated URL for scraping: https://www.timeform.com/horse-racing/results/2024-06-29
2024-07-02T10:56:36Z | INFO - Page load complete. Proceeding to scrape links.
2024-07-02T10:56:39Z | INFO - Page load complete. Proceeding to scrape links.
2024-07-02T10:56:40Z | INFO - Found 81 valid links for date 2024-06-29.
2024-07-02T10:56:40Z | INFO - Inserting 81 links into the database.
2024-07-02T10:56:40Z | INFO - Storing 81 records in rp_raw.days_results_links
2024-07-02T10:56:40Z | INFO - Scrape_links.py execution completed.
2024-07-02T10:57:06Z | INFO - Found 252 valid links for date 2024-06-29.
2024-07-02T10:57:06Z | INFO - Inserting 252 links into the database.
2024-07-02T10:57:06Z | INFO - Storing 252 records in tf_raw.days_results_links
2024-07-02T10:57:07Z | INFO - Scrape_links.py execution completed.
2024-07-02T10:57:07Z | INFO - RP results data scraping started.
2024-07-02T10:57:07Z | INFO - Creating a new headless WebDriver for Timeform: False
2024-07-02T10:57:07Z | INFO - Creating a new WebDriver with headless mode set to True
2024-07-02T10:57:07Z | INFO - TF results data scraping started.
2024-07-02T10:57:07Z | INFO - Creating a new headless WebDriver for Timeform: True
2024-07-02T10:57:07Z | INFO - Creating a new WebDriver with headless mode set to True
2024-07-02T10:57:07Z | INFO - Logging in to Timeform
2024-07-02T10:57:07Z | INFO - Fetching data with query: SELECT * FROM rp_raw.missing_links
2024-07-02T10:57:08Z | INFO - Number of missing links: 51
2024-07-02T10:57:08Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869425
2024-07-02T10:57:11Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869426
2024-07-02T10:57:13Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869427
2024-07-02T10:57:14Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869428
2024-07-02T10:57:16Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869429
2024-07-02T10:57:18Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869430
2024-07-02T10:57:19Z | INFO - Scraping link: https://www.racingpost.com/results/13/chester/2024-06-29/869431
2024-07-02T10:57:21Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/866984
2024-07-02T10:57:24Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869488
2024-07-02T10:57:26Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869489
2024-07-02T10:57:28Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869490
2024-07-02T10:57:31Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869491
2024-07-02T10:57:33Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869492
2024-07-02T10:57:33Z | INFO - Log in to Timeform success
2024-07-02T10:57:33Z | INFO - Fetching data with query: SELECT * FROM tf_raw.missing_links
2024-07-02T10:57:35Z | INFO - Number of missing links: 55
2024-07-02T10:57:35Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/carlisle/2024-06-26/1715/7/7
2024-07-02T10:57:35Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869493
2024-07-02T10:57:37Z | INFO - Scraping link: https://www.racingpost.com/results/1353/newcastle-aw/2024-06-29/869494
2024-07-02T10:57:39Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1350/12/1
2024-07-02T10:57:39Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869418
2024-07-02T10:57:42Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869419
2024-07-02T10:57:43Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1425/12/2
2024-07-02T10:57:44Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869420
2024-07-02T10:57:45Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1500/12/3
2024-07-02T10:57:46Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869421
2024-07-02T10:57:48Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869422
2024-07-02T10:57:49Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1535/12/4
2024-07-02T10:57:50Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869423
2024-07-02T10:57:52Z | INFO - Scraping link: https://www.racingpost.com/results/15/doncaster/2024-06-29/869424
2024-07-02T10:57:52Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1610/12/5
2024-07-02T10:57:54Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869397
2024-07-02T10:57:56Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869398
2024-07-02T10:57:57Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1645/12/6
2024-07-02T10:57:58Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869399
2024-07-02T10:57:59Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/chester/2024-06-29/1720/12/7
2024-07-02T10:58:00Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869400
2024-07-02T10:58:01Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869401
2024-07-02T10:58:02Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1315/204/1
2024-07-02T10:58:03Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869402
2024-07-02T10:58:05Z | INFO - Scraping link: https://www.racingpost.com/results/174/newmarket-july/2024-06-29/869403
2024-07-02T10:58:06Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/867117
2024-07-02T10:58:07Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1345/204/2
2024-07-02T10:58:08Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/869602
2024-07-02T10:58:10Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/870683
2024-07-02T10:58:12Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1420/204/3
2024-07-02T10:58:12Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/871659
2024-07-02T10:58:15Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/871660
2024-07-02T10:58:15Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1455/204/4
2024-07-02T10:58:17Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/871661
2024-07-02T10:58:18Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1530/204/5
2024-07-02T10:58:19Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/871662
2024-07-02T10:58:21Z | INFO - Scraping link: https://www.racingpost.com/results/178/curragh/2024-06-29/871663
2024-07-02T10:58:22Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1605/204/6
2024-07-02T10:58:23Z | INFO - Scraping link: https://www.racingpost.com/results/31/lingfield/2024-06-29/869433
2024-07-02T10:58:24Z | INFO - Scraping link: https://www.racingpost.com/results/31/lingfield/2024-06-29/869434
2024-07-02T10:58:25Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1640/204/7
2024-07-02T10:58:26Z | INFO - Scraping link: https://www.racingpost.com/results/31/lingfield/2024-06-29/869437
2024-07-02T10:58:28Z | INFO - Scraping link: https://www.racingpost.com/results/31/lingfield/2024-06-29/869438
2024-07-02T10:58:29Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/curragh/2024-06-29/1715/204/8
2024-07-02T10:58:30Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-29/869432
2024-07-02T10:58:31Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/1750/14/1
2024-07-02T10:58:31Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-29/869435
2024-07-02T10:58:33Z | INFO - Scraping link: https://www.racingpost.com/results/393/lingfield-aw/2024-06-29/869436
2024-07-02T10:58:35Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/1825/14/2
2024-07-02T10:58:35Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869439
2024-07-02T10:58:37Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869440
2024-07-02T10:58:38Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/1900/14/3
2024-07-02T10:58:38Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869441
2024-07-02T10:58:40Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869442
2024-07-02T10:58:41Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/1930/14/4
2024-07-02T10:58:42Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869443
2024-07-02T10:58:44Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869444
2024-07-02T10:58:45Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/2000/14/5
2024-07-02T10:58:46Z | INFO - Scraping link: https://www.racingpost.com/results/93/windsor/2024-06-29/869445
2024-07-02T10:58:48Z | INFO - Converting data...
2024-07-02T10:58:48Z | INFO - Data converted successfully
2024-07-02T10:58:48Z | INFO - Sorting data...
2024-07-02T10:58:48Z | INFO - Data Columns Index(['race_timestamp', 'race_date', 'course_name', 'race_class',
       'horse_name', 'horse_type', 'horse_age', 'headgear', 'conditions',
       'horse_price', 'race_title', 'distance', 'distance_full', 'going',
       'number_of_runners', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'official_rating', 'horse_weight', 'draw', 'country',
       'surface', 'finishing_position', 'total_distance_beaten', 'ts_value',
       'rpr_value', 'extra_weight', 'comment', 'race_time', 'currency',
       'course', 'jockey_name', 'jockey_claim', 'trainer_name', 'sire_name',
       'dam_name', 'dams_sire', 'owner_name', 'horse_id', 'trainer_id',
       'jockey_id', 'sire_id', 'dam_id', 'dams_sire_id', 'owner_id', 'race_id',
       'course_id', 'meeting_id', 'unique_id', 'debug_link', 'created_at'],
      dtype='object')
2024-07-02T10:58:48Z | INFO - Data Sample        race_timestamp  ...          created_at
0 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
1 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
2 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
3 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
4 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
5 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
6 2024-06-29 15:35:00  ... 2024-07-02 10:57:09
0 2024-06-29 17:20:00  ... 2024-07-02 10:57:11
1 2024-06-29 17:20:00  ... 2024-07-02 10:57:11
2 2024-06-29 17:20:00  ... 2024-07-02 10:57:11

[10 rows x 52 columns]
2024-07-02T10:58:48Z | INFO - Data Sample        race_timestamp  ...          created_at
8 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
7 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
6 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
5 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
4 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
3 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
2 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
1 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
0 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
4 2024-06-29 17:32:00  ... 2024-07-02 10:58:44

[10 rows x 52 columns]
2024-07-02T10:58:48Z | INFO - Validating data...
2024-07-02T10:58:48Z | INFO - Data validated successfully
2024-07-02T10:58:48Z | INFO - Sorting data...
2024-07-02T10:58:48Z | INFO - Data Columns Index(['race_timestamp', 'race_date', 'course_name', 'race_class',
       'horse_name', 'horse_type', 'horse_age', 'headgear', 'conditions',
       'horse_price', 'race_title', 'distance', 'distance_full', 'going',
       'number_of_runners', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'official_rating', 'horse_weight', 'draw', 'country',
       'surface', 'finishing_position', 'total_distance_beaten', 'ts_value',
       'rpr_value', 'extra_weight', 'comment', 'race_time', 'currency',
       'course', 'jockey_name', 'jockey_claim', 'trainer_name', 'sire_name',
       'dam_name', 'dams_sire', 'owner_name', 'horse_id', 'trainer_id',
       'jockey_id', 'sire_id', 'dam_id', 'dams_sire_id', 'owner_id', 'race_id',
       'course_id', 'meeting_id', 'unique_id', 'debug_link', 'created_at'],
      dtype='object')
2024-07-02T10:58:48Z | INFO - Data Sample        race_timestamp  ...          created_at
8 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
7 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
6 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
5 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
4 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
3 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
2 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
1 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
0 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
4 2024-06-29 17:32:00  ... 2024-07-02 10:58:44

[10 rows x 52 columns]
2024-07-02T10:58:48Z | INFO - Data Sample        race_timestamp  ...          created_at
8 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
6 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
5 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
4 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
3 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
2 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
1 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
0 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
7 2024-06-29 14:42:00  ... 2024-07-02 10:58:47
5 2024-06-29 17:32:00  ... 2024-07-02 10:58:44

[10 rows x 52 columns]
2024-07-02T10:58:48Z | INFO - Storing 443 records in rp_raw.performance_data
2024-07-02T10:58:48Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_rp_data'
2024-07-02T10:58:48Z | INFO - Query executed. Number of rows affected: 1
2024-07-02T10:58:49Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/2030/14/6
2024-07-02T10:58:51Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/doncaster/2024-06-29/2100/14/7
2024-07-02T10:58:54Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/kempton-park/2024-06-26/1910/27/5
2024-07-02T10:58:59Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/kempton-park/2024-06-26/2010/27/7
2024-07-02T10:59:04Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/leicester/2024-06-27/1800/29/1
2024-07-02T10:59:06Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/1740/30/1
2024-07-02T10:59:10Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/1810/30/2
2024-07-02T10:59:14Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/1845/30/3
2024-07-02T10:59:17Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/1915/30/4
2024-07-02T10:59:21Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/1945/30/5
2024-07-02T10:59:23Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/2015/30/6
2024-07-02T10:59:26Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/lingfield-park/2024-06-29/2045/30/7
2024-07-02T10:59:29Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1335/35/1
2024-07-02T10:59:40Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1404/35/2
2024-07-02T10:59:43Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1435/35/3
2024-07-02T10:59:49Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1510/35/4
2024-07-02T10:59:54Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1540/35/5
2024-07-02T10:59:57Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1615/35/6
2024-07-02T10:59:59Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1650/35/7
2024-07-02T11:00:03Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newcastle/2024-06-29/1725/35/8
2024-07-02T11:00:09Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1340/60/1
2024-07-02T11:00:10Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1415/60/2
2024-07-02T11:00:13Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1450/60/3
2024-07-02T11:00:15Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1525/60/4
2024-07-02T11:00:17Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1600/60/5
2024-07-02T11:00:19Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1635/60/6
2024-07-02T11:00:21Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/newmarket/2024-06-29/1710/60/7
2024-07-02T11:00:23Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1410/57/1
2024-07-02T11:00:25Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1442/57/2
2024-07-02T11:00:28Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1517/57/3
2024-07-02T11:00:30Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1552/57/4
2024-07-02T11:00:31Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1625/57/5
2024-07-02T11:00:35Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1700/57/6
2024-07-02T11:00:37Z | INFO - Scraping link: https://www.timeform.com/horse-racing/result/windsor/2024-06-29/1732/57/7
2024-07-02T11:00:40Z | INFO - Converting data...
2024-07-02T11:00:40Z | INFO - Data converted successfully
2024-07-02T11:00:40Z | INFO - Sorting data...
2024-07-02T11:00:40Z | INFO - Data Columns Index(['tf_rating', 'tf_speed_figure', 'draw', 'finishing_position',
       'horse_name', 'horse_id', 'horse_name_link', 'sire_name', 'dam_name',
       'sire_id', 'dam_id', 'trainer_name', 'trainer_id', 'jockey_name',
       'jockey_id', 'horse_age', 'equipment', 'official_rating',
       'fractional_price', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'course', 'race_date', 'race_time',
       'race_timestamp', 'course_id', 'race', 'race_id', 'distance', 'going',
       'prize', 'hcap_range', 'age_range', 'race_type', 'main_race_comment',
       'debug_link', 'created_at', 'unique_id'],
      dtype='object')
2024-07-02T11:00:40Z | INFO - Data Sample   tf_rating  ...                                          unique_id
0       89+  ...  7f8de06b1fdd94fcaaccef20a99cb6a5f10cd519e9fcbf...
1        80  ...  8e5f613fe3f3f2765ee557c053ac992785b9e4f1f569bd...
2        71  ...  d5ed36fc2fd1da1953ecd1301c305447a4852d0aec1156...
3       75+  ...  dcbb41be6b62859c34d5b8de04cc0edc702a67b86232dd...
4        77  ...  95b9072e0fa4877ed381a31210eebf42ccc0f65fc68f2f...
5       76+  ...  b1d439ed66899b3e9d877a3ae172042109cd03bacf0afe...
6        68  ...  27c3a1db5393a825472b5651b9a61ddfaacfeed4f7c55b...
7        53  ...  f86a0ce8a9abd11edef5c7c1b49cffddd48621da49baea...
0       88+  ...  851f00f692a9860ae70dc39baadc7d24ec7527c0e3a381...
1        70  ...  eb6c5e6a81664e5693f411b17a80d283b090fb9519873b...

[10 rows x 40 columns]
2024-07-02T11:00:40Z | INFO - Data Sample   tf_rating  ...                                          unique_id
7        20  ...  db6a9196053cd8248164db68f32945e76e8d7befeab842...
6        24  ...  8af65a13719240e0d0a605d205336a74d620895558e8df...
5        32  ...  df12552ad18ae55bf864894864f0c26352b7e93cd22360...
4        51  ...  4a1c8cc5f4a9f73dae49fd4c84624ba979d282d850c456...
3       52?  ...  a9c19706eb2889744c3ba26b0d73c97691cefbb911de2a...
2        42  ...  80cf425c57bb79030abd7e1010221d23a371992d096998...
1       59+  ...  d763a3834df95b4c38707bfc03cf193763b491de9cd1fc...
0        68  ...  b6a7f856bde1f2ddcfca380fd6cc7333ccd977a96a8994...
6        41  ...  148b794a2d505f5a889658dbc6ba5ac061fb064f4a16c3...
5        60  ...  f5ef3add38a1db1be8dbe757ce5dd9a6f7bae12ee7d280...

[10 rows x 40 columns]
2024-07-02T11:00:40Z | INFO - Validating data...
2024-07-02T11:00:40Z | INFO - Data validated successfully
2024-07-02T11:00:40Z | INFO - Sorting data...
2024-07-02T11:00:40Z | INFO - Data Columns Index(['tf_rating', 'tf_speed_figure', 'draw', 'trainer_name', 'trainer_id',
       'jockey_name', 'jockey_id', 'sire_name', 'sire_id', 'dam_name',
       'dam_id', 'finishing_position', 'horse_name', 'horse_id',
       'horse_name_link', 'horse_age', 'equipment', 'official_rating',
       'fractional_price', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'course', 'race_date', 'race_time',
       'race_timestamp', 'course_id', 'race', 'race_id', 'distance', 'going',
       'prize', 'hcap_range', 'age_range', 'race_type', 'main_race_comment',
       'debug_link', 'created_at', 'unique_id'],
      dtype='object')
2024-07-02T11:00:40Z | INFO - Data Sample   tf_rating  ...                                          unique_id
7        20  ...  db6a9196053cd8248164db68f32945e76e8d7befeab842...
6        24  ...  8af65a13719240e0d0a605d205336a74d620895558e8df...
5        32  ...  df12552ad18ae55bf864894864f0c26352b7e93cd22360...
4        51  ...  4a1c8cc5f4a9f73dae49fd4c84624ba979d282d850c456...
3       52?  ...  a9c19706eb2889744c3ba26b0d73c97691cefbb911de2a...
2        42  ...  80cf425c57bb79030abd7e1010221d23a371992d096998...
1       59+  ...  d763a3834df95b4c38707bfc03cf193763b491de9cd1fc...
0        68  ...  b6a7f856bde1f2ddcfca380fd6cc7333ccd977a96a8994...
6        41  ...  148b794a2d505f5a889658dbc6ba5ac061fb064f4a16c3...
5        60  ...  f5ef3add38a1db1be8dbe757ce5dd9a6f7bae12ee7d280...

[10 rows x 40 columns]
2024-07-02T11:00:40Z | INFO - Data Sample   tf_rating  ...                                          unique_id
7        20  ...  db6a9196053cd8248164db68f32945e76e8d7befeab842...
6        24  ...  8af65a13719240e0d0a605d205336a74d620895558e8df...
5        32  ...  df12552ad18ae55bf864894864f0c26352b7e93cd22360...
4        51  ...  4a1c8cc5f4a9f73dae49fd4c84624ba979d282d850c456...
3       52?  ...  a9c19706eb2889744c3ba26b0d73c97691cefbb911de2a...
2        42  ...  80cf425c57bb79030abd7e1010221d23a371992d096998...
1       59+  ...  d763a3834df95b4c38707bfc03cf193763b491de9cd1fc...
0        68  ...  b6a7f856bde1f2ddcfca380fd6cc7333ccd977a96a8994...
6        41  ...  148b794a2d505f5a889658dbc6ba5ac061fb064f4a16c3...
5        60  ...  f5ef3add38a1db1be8dbe757ce5dd9a6f7bae12ee7d280...

[10 rows x 40 columns]
2024-07-02T11:00:40Z | INFO - Storing 478 records in tf_raw.performance_data
2024-07-02T11:00:40Z | INFO - Executing query: UPDATE metrics.processing_times SET processed_at = NOW() WHERE job_name = 'scrape_tf_data'
2024-07-02T11:00:40Z | INFO - Query executed. Number of rows affected: 1
2024-07-02T11:00:41Z | INFO - Checking for missing data...
2024-07-02T11:00:41Z | INFO - Fetching data with query: SELECT * FROM rp_raw.missing_links;
2024-07-02T11:00:41Z | INFO - Fetching data with query: SELECT * FROM tf_raw.missing_links;
2024-07-02T11:00:41Z | INFO - All RP data scraped successfully
2024-07-02T11:00:41Z | INFO - Loading direct matches
2024-07-02T11:00:41Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_sires;
2024-07-02T11:00:41Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_dams;
2024-07-02T11:00:41Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_horses;
2024-07-02T11:00:41Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_jockeys;
2024-07-02T11:00:42Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_trainers;
2024-07-02T11:00:42Z | INFO - Fetching data with query: SELECT * FROM rp_raw.unmatched_owners;
2024-07-02T11:00:42Z | INFO - Fetching data with query: SELECT * FROM public.owner
2024-07-02T11:00:42Z | INFO - Storing 10 records in public.owner
/Users/tomwattley/Code/python/racing-api-project/racing-etl/src/pipelines/matching_pipeline.py:96: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  rp_matching_data = pd.concat(
2024-07-02T11:00:42Z | INFO - Fetching data with query: 
        SELECT pd.horse_name,
            pd.horse_id,
            pd.horse_age,
            pd.jockey_id,
            pd.jockey_name,
            pd.trainer_id,
            pd.trainer_name,
            pd.sire_name,
            pd.sire_id,
            pd.dam_name,
            pd.dam_id,
            pd.race_timestamp,
            pd.unique_id,
            pd.race_date,
            pd.debug_link,
            c.id AS course_id
        FROM tf_raw.performance_data pd
        LEFT JOIN public.course c 
        ON pd.course_id = c.tf_id
        WHERE pd.race_date 
        IN ('2024-06-29')
        
2024-07-02T11:00:42Z | INFO - Fetching data with query: 
        SELECT pd.horse_name,
            pd.horse_id,
            pd.horse_age,
            pd.jockey_id,
            pd.jockey_name,
            pd.trainer_id,
            pd.trainer_name,
            pd.sire_name,
            pd.sire_id,
            pd.dam_name,
            pd.dam_id,
            pd.race_timestamp,
            pd.unique_id,
            pd.race_date,
            pd.debug_link,
            c.id AS course_id
        FROM tf_raw.todays_performance_data pd
        LEFT JOIN public.course c 
        ON pd.course_id = c.tf_id
        WHERE pd.race_date 
        IN ('2024-06-29')
        
/Users/tomwattley/Code/python/racing-api-project/racing-etl/src/pipelines/matching_pipeline.py:123: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  tf_matching_data = pd.concat([tf_hist_data, tf_present_data]).drop_duplicates(
2024-07-02T11:00:42Z | INFO - Loading matching data for 14 dates
2024-07-02T11:00:42Z | INFO - Found 443 records for dates :['2024-06-29']
2024-07-02T11:00:42Z | INFO - Missing entities: ['sire' 'dam' 'horse']
2024-07-02T11:00:42Z | INFO - Matching War Of Will
2024-07-02T11:00:42Z | INFO - Found match for War Of Will
2024-07-02T11:00:42Z | INFO - Matching Complexity
2024-07-02T11:00:42Z | INFO - Found match for Complexity
2024-07-02T11:00:42Z | INFO - Matching Palace Malice
2024-07-02T11:00:42Z | INFO - Found match for Palace Malice
2024-07-02T11:00:42Z | INFO - Matching Say Its Me
2024-07-02T11:00:42Z | INFO - Found match for Say Its Me
2024-07-02T11:00:42Z | INFO - Matching Tusked Wings
2024-07-02T11:00:42Z | INFO - Found match for Tusked Wings
2024-07-02T11:00:42Z | INFO - Matching Mutually Benefit
2024-07-02T11:00:42Z | INFO - Found match for Mutually Benefit
2024-07-02T11:00:42Z | INFO - Matching Emerald Green
2024-07-02T11:00:42Z | INFO - Found match for Emerald Green
2024-07-02T11:00:42Z | INFO - Matching Minnie Haha
2024-07-02T11:00:42Z | INFO - Found match for Minnie Haha
2024-07-02T11:00:42Z | INFO - Matching Nabeyla
2024-07-02T11:00:42Z | INFO - Found match for Nabeyla
2024-07-02T11:00:42Z | INFO - Matching Mohassan
2024-07-02T11:00:42Z | INFO - Found match for Mohassan
2024-07-02T11:00:42Z | INFO - Matching Harlee Honey
2024-07-02T11:00:42Z | INFO - Found match for Harlee Honey
2024-07-02T11:00:42Z | INFO - Matching Princess Haya
2024-07-02T11:00:43Z | INFO - Found match for Princess Haya
2024-07-02T11:00:43Z | INFO - Matching Razzmatazz
2024-07-02T11:00:43Z | INFO - Found match for Razzmatazz
2024-07-02T11:00:43Z | INFO - Matching Artilena
2024-07-02T11:00:43Z | INFO - Found match for Artilena
2024-07-02T11:00:43Z | INFO - Matching Texanne
2024-07-02T11:00:43Z | INFO - Found match for Texanne
2024-07-02T11:00:43Z | INFO - Matching Mountain Dreams
2024-07-02T11:00:43Z | INFO - Found match for Mountain Dreams
2024-07-02T11:00:43Z | INFO - Matching Cassima
2024-07-02T11:00:43Z | INFO - Found match for Cassima
2024-07-02T11:00:43Z | INFO - Matching Uncle Bonni
2024-07-02T11:00:43Z | INFO - Found match for Uncle Bonni
2024-07-02T11:00:43Z | INFO - Matching Groundsman
2024-07-02T11:00:43Z | INFO - Found match for Groundsman
2024-07-02T11:00:43Z | INFO - Matching Trinity College
2024-07-02T11:00:43Z | INFO - Found match for Trinity College
2024-07-02T11:00:43Z | INFO - Matching Tasmania
2024-07-02T11:00:43Z | INFO - Found match for Tasmania
2024-07-02T11:00:43Z | INFO - Matching Tango Five
2024-07-02T11:00:43Z | INFO - Found match for Tango Five
2024-07-02T11:00:43Z | INFO - Matching Sibari
2024-07-02T11:00:43Z | INFO - Found match for Sibari
2024-07-02T11:00:43Z | INFO - Matching Show Your Workings
2024-07-02T11:00:43Z | INFO - Found match for Show Your Workings
2024-07-02T11:00:43Z | INFO - Matching Seurat
2024-07-02T11:00:43Z | INFO - Found match for Seurat
2024-07-02T11:00:43Z | INFO - Matching Serienmond
2024-07-02T11:00:43Z | INFO - Found match for Serienmond
2024-07-02T11:00:43Z | INFO - Matching Rock Of Cashel
2024-07-02T11:00:43Z | INFO - Found match for Rock Of Cashel
2024-07-02T11:00:43Z | INFO - Matching Red Charlie
2024-07-02T11:00:43Z | INFO - Found match for Red Charlie
2024-07-02T11:00:43Z | INFO - Matching Justified Risk
2024-07-02T11:00:43Z | INFO - Found match for Justified Risk
2024-07-02T11:00:43Z | INFO - Matching Jamarr
2024-07-02T11:00:43Z | INFO - Found match for Jamarr
2024-07-02T11:00:43Z | INFO - Matching High Favour
2024-07-02T11:00:43Z | INFO - Found match for High Favour
2024-07-02T11:00:43Z | INFO - Matching Green Impact
2024-07-02T11:00:43Z | INFO - Found match for Green Impact
2024-07-02T11:00:43Z | INFO - Matching El Regalo
2024-07-02T11:00:43Z | INFO - Found match for El Regalo
2024-07-02T11:00:43Z | INFO - Matching Daler
2024-07-02T11:00:43Z | INFO - Found match for Daler
2024-07-02T11:00:43Z | INFO - Matching Currawood
2024-07-02T11:00:43Z | INFO - Found match for Currawood
2024-07-02T11:00:43Z | INFO - Matching Black Forza
2024-07-02T11:00:43Z | INFO - Found match for Black Forza
2024-07-02T11:00:43Z | INFO - Matching Bernard Shaw
2024-07-02T11:00:43Z | INFO - Found match for Bernard Shaw
2024-07-02T11:00:43Z | INFO - Matching Apples And Bananas
2024-07-02T11:00:43Z | INFO - Found match for Apples And Bananas
2024-07-02T11:00:43Z | INFO - Matching Piperstown
2024-07-02T11:00:43Z | INFO - Found match for Piperstown
2024-07-02T11:00:43Z | INFO - Matching Pinsent
2024-07-02T11:00:43Z | INFO - Found match for Pinsent
2024-07-02T11:00:43Z | INFO - Matching Melissa Honey
2024-07-02T11:00:43Z | INFO - Found match for Melissa Honey
2024-07-02T11:00:43Z | INFO - Matching Logical Lady
2024-07-02T11:00:43Z | INFO - Found match for Logical Lady
2024-07-02T11:00:43Z | INFO - Matching Last Outlaw
2024-07-02T11:00:43Z | INFO - Found match for Last Outlaw
2024-07-02T11:00:43Z | INFO - Matching Harvesting
2024-07-02T11:00:43Z | INFO - Found match for Harvesting
2024-07-02T11:00:43Z | INFO - Matching Glamis Road
2024-07-02T11:00:43Z | INFO - Found match for Glamis Road
2024-07-02T11:00:43Z | INFO - Matching Bouvier
2024-07-02T11:00:43Z | INFO - Found match for Bouvier
2024-07-02T11:00:43Z | INFO - Matching Balayaged
2024-07-02T11:00:43Z | INFO - Found match for Balayaged
2024-07-02T11:00:43Z | INFO - Matching Saint Fonteyn
2024-07-02T11:00:43Z | INFO - Found match for Saint Fonteyn
2024-07-02T11:00:43Z | INFO - Matching Coto De Caza
2024-07-02T11:00:43Z | INFO - Found match for Coto De Caza
2024-07-02T11:00:43Z | INFO - Matching Andantini
2024-07-02T11:00:43Z | INFO - Found match for Andantini
2024-07-02T11:00:43Z | INFO - Matching Dutch Finale
2024-07-02T11:00:43Z | INFO - Found match for Dutch Finale
2024-07-02T11:00:43Z | INFO - Matching Darlas Secret
2024-07-02T11:00:43Z | INFO - Found match for Darlas Secret
2024-07-02T11:00:43Z | INFO - Matching Paradise Springs
2024-07-02T11:00:43Z | INFO - Found match for Paradise Springs
2024-07-02T11:00:43Z | INFO - Matching Yakfeek
2024-07-02T11:00:43Z | INFO - Found match for Yakfeek
2024-07-02T11:00:43Z | INFO - Matching Wheels Of Fire
2024-07-02T11:00:43Z | INFO - Found match for Wheels Of Fire
2024-07-02T11:00:43Z | INFO - Matching Qaaeadd
2024-07-02T11:00:43Z | INFO - Found match for Qaaeadd
2024-07-02T11:00:43Z | INFO - Matching Havana Club
2024-07-02T11:00:43Z | INFO - Found match for Havana Club
2024-07-02T11:00:43Z | INFO - Fetching data with query: SELECT * FROM public.horse
2024-07-02T11:00:43Z | INFO - Fetching data with query: SELECT * FROM public.sire
2024-07-02T11:00:43Z | INFO - Fetching data with query: SELECT * FROM public.dam
2024-07-02T11:00:43Z | INFO - Fetching data with query: SELECT * FROM public.jockey
2024-07-02T11:00:43Z | INFO - Fetching data with query: SELECT * FROM public.trainer
2024-07-02T11:00:43Z | INFO - No data to store in public.trainer
2024-07-02T11:00:43Z | INFO - No data to store in public.jockey
2024-07-02T11:00:43Z | INFO - Storing 3 records in public.sire
2024-07-02T11:00:43Z | INFO - Storing 14 records in public.dam
2024-07-02T11:00:43Z | INFO - Storing 40 records in public.horse
2024-07-02T11:00:43Z | INFO - Calling stored procedure staging.insert_into_joined_performance_data()
2024-07-02T11:00:43Z | INFO - Calling stored procedure staging.insert_into_todays_joined_performance_data()
2024-07-02T11:00:43Z | INFO - Stored procedure staging.insert_into_todays_joined_performance_data() completed
2024-07-02T11:00:48Z | INFO - Stored procedure staging.insert_into_joined_performance_data() completed
2024-07-02T11:00:48Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM rp_raw.todays_performance_data;
2024-07-02T11:00:48Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM staging.todays_joined_performance_data;
2024-07-02T11:00:48Z | WARNING - MISSING DATA RAW: 788 STAGING: 0
2024-07-02T11:00:48Z | INFO - Starting Betfair matching
2024-07-02T11:00:48Z | INFO - Fetching data with query: 
                    SELECT race_timestamp, h.id, horse_name 
                    FROM rp_raw.todays_performance_data tpd
                    LEFT JOIN horse h
                    ON tpd.horse_id = h.rp_id
            
2024-07-02T11:00:48Z | INFO - Fetching data with query: SELECT race_time, horse_id, horse_name FROM bf_raw.todays_price_data
2024-07-02T11:00:48Z | INFO - Matched 257 of 257 horses
2024-07-02T11:00:48Z | INFO - Truncating public.bf_horse
2024-07-02T11:00:48Z | INFO - Executing query: TRUNCATE TABLE public.bf_horse
2024-07-02T11:00:48Z | INFO - Query executed. Number of rows affected: -1
2024-07-02T11:00:48Z | INFO - Storing 257 records in public.bf_horse
2024-07-02T11:00:48Z | INFO - Fetching data with query: SELECT * FROM public.missing_performance_data_vw;
2024-07-02T11:00:48Z | INFO - Fetching data with query: SELECT * FROM public.missing_todays_performance_data_vw;
2024-07-02T11:00:48Z | INFO - No missing today's data to transform.
2024-07-02T11:00:51Z | INFO - Mapping race time column
2024-07-02T11:00:51Z | INFO - Getting surfaces from tf rating
2024-07-02T11:00:51Z | INFO - Getting tf rating values
2024-07-02T11:00:51Z | INFO - Creating pounds
2024-07-02T11:00:51Z | INFO - Getting inplay high and low
2024-07-02T11:00:51Z | INFO - Creating distance data
2024-07-02T11:00:51Z | INFO - Creating time data
2024-07-02T11:00:51Z | INFO - Creating headgear data
2024-07-02T11:00:51Z | INFO - Converting tf rating
2024-07-02T11:00:51Z | INFO - Cleaning race class field
2024-07-02T11:00:51Z | INFO - Converting horse type to colour and sex
2024-07-02T11:00:51Z | INFO - Creating distance beaten data
2024-07-02T11:00:51Z | INFO - Converting data...
2024-07-02T11:00:51Z | INFO - Data converted successfully
2024-07-02T11:00:51Z | INFO - Sorting data...
2024-07-02T11:00:51Z | INFO - Data Columns Index(['horse_name', 'horse_age', 'jockey_name', 'jockey_claim',
       'trainer_name', 'owner_name', 'weight_carried', 'draw',
       'finishing_position', 'total_distance_beaten', 'age', 'official_rating',
       'ts', 'rpr', 'industry_sp', 'extra_weight', 'headgear',
       'in_race_comment', 'sire_name', 'dam_name', 'dams_sire', 'race_date',
       'race_title', 'race_time_original', 'race_time', 'race_class',
       'conditions', 'distance', 'going', 'winning_time', 'number_of_runners',
       'total_prize_money', 'first_place_prize_money', 'currency', 'country',
       'surface', 'tfr', 'tfig', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'hcap_range', 'age_range', 'race_type',
       'main_race_comment', 'meeting_id', 'course_id', 'horse_id', 'sire_id',
       'dam_id', 'trainer_id', 'jockey_id', 'owner_id', 'race_id', 'unique_id',
       'created_at', 'data_type', 'tfr_view', 'weight_carried_st',
       'weight_carried_extra_lbs', 'weight_carried_lbs', 'in_play_low',
       'in_play_high', 'distance_yards', 'distance_meters',
       'distance_kilometers', 'time_seconds', 'relative_to_standard',
       'relative_time', 'horse_colour', 'horse_sex',
       'total_distance_beaten_str'],
      dtype='object')
2024-07-02T11:00:51Z | INFO - Data Sample         horse_name horse_age  ... horse_sex total_distance_beaten_str
0       River Edge         3  ...   Gelding                         8
1      Self Belief         5  ...   Gelding                      [8½]
2      Alpine Girl         4  ...     Filly                          
3       Harvesting         2  ...     Filly                      [5½]
4    Last Crusader         5  ...   Gelding                     [35¼]
5   Sunshine State         2  ...     Filly                      [8½]
6     Emily Upjohn         5  ...      Mare                         ½
7  Champagne Sarah         4  ...     Filly                      [3¾]
8    Dreams Adozen         4  ...     Filly                      [3¼]
9   Winter Reprise         7  ...   Gelding                      [8½]

[10 rows x 73 columns]
2024-07-02T11:00:51Z | INFO - Data Sample               race_time  ...                 created_at
0   2024-06-27 18:00:00  ... 2024-07-02 11:00:43.724534
314 2024-06-29 19:00:00  ... 2024-07-02 11:00:43.724534
326 2024-06-29 13:35:00  ... 2024-07-02 11:00:43.724534
325 2024-06-29 15:00:00  ... 2024-07-02 11:00:43.724534
324 2024-06-29 14:25:00  ... 2024-07-02 11:00:43.724534
323 2024-06-29 13:35:00  ... 2024-07-02 11:00:43.724534
322 2024-06-29 18:25:00  ... 2024-07-02 11:00:43.724534
321 2024-06-29 14:15:00  ... 2024-07-02 11:00:43.724534
320 2024-06-29 17:50:00  ... 2024-07-02 11:00:43.724534
319 2024-06-29 16:40:00  ... 2024-07-02 11:00:43.724534

[10 rows x 36 columns]
2024-07-02T11:00:51Z | INFO - Validating data...
2024-07-02T11:00:51Z | INFO - Data validated successfully
2024-07-02T11:00:51Z | INFO - Sorting data...
2024-07-02T11:00:51Z | INFO - Data Columns Index(['race_time', 'race_date', 'horse_name', 'age', 'horse_sex', 'draw',
       'headgear', 'weight_carried', 'weight_carried_lbs', 'extra_weight',
       'jockey_claim', 'finishing_position', 'total_distance_beaten',
       'industry_sp', 'betfair_win_sp', 'betfair_place_sp', 'official_rating',
       'ts', 'rpr', 'tfig', 'tfr', 'in_play_high', 'in_play_low',
       'in_race_comment', 'tf_comment', 'tfr_view', 'race_id', 'course_id',
       'horse_id', 'jockey_id', 'trainer_id', 'owner_id', 'sire_id', 'dam_id',
       'unique_id', 'created_at'],
      dtype='object')
2024-07-02T11:00:51Z | INFO - Data Sample               race_time  ...                 created_at
0   2024-06-27 18:00:00  ... 2024-07-02 11:00:43.724534
314 2024-06-29 19:00:00  ... 2024-07-02 11:00:43.724534
326 2024-06-29 13:35:00  ... 2024-07-02 11:00:43.724534
325 2024-06-29 15:00:00  ... 2024-07-02 11:00:43.724534
324 2024-06-29 14:25:00  ... 2024-07-02 11:00:43.724534
323 2024-06-29 13:35:00  ... 2024-07-02 11:00:43.724534
322 2024-06-29 18:25:00  ... 2024-07-02 11:00:43.724534
321 2024-06-29 14:15:00  ... 2024-07-02 11:00:43.724534
320 2024-06-29 17:50:00  ... 2024-07-02 11:00:43.724534
319 2024-06-29 16:40:00  ... 2024-07-02 11:00:43.724534

[10 rows x 36 columns]
2024-07-02T11:00:51Z | INFO - Data Sample              race_time  ...                 created_at
0  2024-06-27 18:00:00  ... 2024-07-02 11:00:43.724534
14 2024-06-29 19:00:00  ... 2024-07-02 11:00:43.724534
3  2024-06-29 19:30:00  ... 2024-07-02 11:00:43.724534
4  2024-06-29 15:00:00  ... 2024-07-02 11:00:43.724534
5  2024-06-29 14:15:00  ... 2024-07-02 11:00:43.724534
6  2024-06-29 15:30:00  ... 2024-07-02 11:00:43.724534
7  2024-06-29 17:50:00  ... 2024-07-02 11:00:43.724534
8  2024-06-29 16:10:00  ... 2024-07-02 11:00:43.724534
9  2024-06-29 16:50:00  ... 2024-07-02 11:00:43.724534
10 2024-06-29 16:00:00  ... 2024-07-02 11:00:43.724534

[10 rows x 36 columns]
2024-07-02T11:00:51Z | INFO - Converting data...
2024-07-02T11:00:51Z | INFO - Data converted successfully
2024-07-02T11:00:51Z | INFO - Sorting data...
2024-07-02T11:00:51Z | INFO - Data Columns Index(['horse_name', 'horse_age', 'jockey_name', 'jockey_claim',
       'trainer_name', 'owner_name', 'weight_carried', 'draw',
       'finishing_position', 'total_distance_beaten', 'age', 'official_rating',
       'ts', 'rpr', 'industry_sp', 'extra_weight', 'headgear',
       'in_race_comment', 'sire_name', 'dam_name', 'dams_sire', 'race_date',
       'race_title', 'race_time_original', 'race_time', 'race_class',
       'conditions', 'distance', 'going', 'winning_time', 'number_of_runners',
       'total_prize_money', 'first_place_prize_money', 'currency', 'country',
       'surface', 'tfr', 'tfig', 'betfair_win_sp', 'betfair_place_sp',
       'in_play_prices', 'tf_comment', 'hcap_range', 'age_range', 'race_type',
       'main_race_comment', 'meeting_id', 'course_id', 'horse_id', 'sire_id',
       'dam_id', 'trainer_id', 'jockey_id', 'owner_id', 'race_id', 'unique_id',
       'created_at', 'data_type', 'tfr_view', 'weight_carried_st',
       'weight_carried_extra_lbs', 'weight_carried_lbs', 'in_play_low',
       'in_play_high', 'distance_yards', 'distance_meters',
       'distance_kilometers', 'time_seconds', 'relative_to_standard',
       'relative_time', 'horse_colour', 'horse_sex',
       'total_distance_beaten_str'],
      dtype='object')
2024-07-02T11:00:51Z | INFO - Data Sample         horse_name horse_age  ... horse_sex total_distance_beaten_str
0       River Edge         3  ...   Gelding                         8
1      Self Belief         5  ...   Gelding                      [8½]
2      Alpine Girl         4  ...     Filly                          
3       Harvesting         2  ...     Filly                      [5½]
4    Last Crusader         5  ...   Gelding                     [35¼]
5   Sunshine State         2  ...     Filly                      [8½]
6     Emily Upjohn         5  ...      Mare                         ½
7  Champagne Sarah         4  ...     Filly                      [3¾]
8    Dreams Adozen         4  ...     Filly                      [3¼]
9   Winter Reprise         7  ...   Gelding                      [8½]

[10 rows x 73 columns]
2024-07-02T11:00:51Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-27 18:00:00  2024-06-27  ...        44 2024-07-02 11:00:43.724534
314 2024-06-29 19:00:00  2024-06-29  ...        20 2024-07-02 11:00:43.724534
326 2024-06-29 13:35:00  2024-06-29  ...        56 2024-07-02 11:00:43.724534
325 2024-06-29 15:00:00  2024-06-29  ...        16 2024-07-02 11:00:43.724534
324 2024-06-29 14:25:00  2024-06-29  ...        16 2024-07-02 11:00:43.724534
322 2024-06-29 18:25:00  2024-06-29  ...        20 2024-07-02 11:00:43.724534
321 2024-06-29 14:15:00  2024-06-29  ...        58 2024-07-02 11:00:43.724534
320 2024-06-29 17:50:00  2024-06-29  ...        20 2024-07-02 11:00:43.724534
319 2024-06-29 16:40:00  2024-06-29  ...        19 2024-07-02 11:00:43.724534
317 2024-06-29 14:04:00  2024-06-29  ...        56 2024-07-02 11:00:43.724534

[10 rows x 27 columns]
2024-07-02T11:00:51Z | INFO - Validating data...
2024-07-02T11:00:51Z | INFO - Data validated successfully
2024-07-02T11:00:51Z | INFO - Sorting data...
2024-07-02T11:00:51Z | INFO - Data Columns Index(['race_time', 'race_date', 'race_title', 'race_type', 'race_class',
       'distance', 'distance_yards', 'distance_meters', 'distance_kilometers',
       'conditions', 'going', 'number_of_runners', 'hcap_range', 'age_range',
       'surface', 'total_prize_money', 'first_place_prize_money',
       'winning_time', 'time_seconds', 'relative_time', 'relative_to_standard',
       'country', 'main_race_comment', 'meeting_id', 'race_id', 'course_id',
       'created_at'],
      dtype='object')
2024-07-02T11:00:51Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-27 18:00:00  2024-06-27  ...        44 2024-07-02 11:00:43.724534
314 2024-06-29 19:00:00  2024-06-29  ...        20 2024-07-02 11:00:43.724534
326 2024-06-29 13:35:00  2024-06-29  ...        56 2024-07-02 11:00:43.724534
325 2024-06-29 15:00:00  2024-06-29  ...        16 2024-07-02 11:00:43.724534
324 2024-06-29 14:25:00  2024-06-29  ...        16 2024-07-02 11:00:43.724534
322 2024-06-29 18:25:00  2024-06-29  ...        20 2024-07-02 11:00:43.724534
321 2024-06-29 14:15:00  2024-06-29  ...        58 2024-07-02 11:00:43.724534
320 2024-06-29 17:50:00  2024-06-29  ...        20 2024-07-02 11:00:43.724534
319 2024-06-29 16:40:00  2024-06-29  ...        19 2024-07-02 11:00:43.724534
317 2024-06-29 14:04:00  2024-06-29  ...        56 2024-07-02 11:00:43.724534

[10 rows x 27 columns]
2024-07-02T11:00:51Z | INFO - Data Sample               race_time   race_date  ... course_id                 created_at
0   2024-06-27 18:00:00  2024-06-27  ...        44 2024-07-02 11:00:43.724534
248 2024-06-29 15:52:00  2024-06-29  ...        88 2024-07-02 11:00:43.724534
330 2024-06-29 15:30:00  2024-06-29  ...        19 2024-07-02 11:00:43.724534
341 2024-06-29 16:00:00  2024-06-29  ...        58 2024-07-02 11:00:43.724534
340 2024-06-29 16:35:00  2024-06-29  ...        58 2024-07-02 11:00:43.724534
339 2024-06-26 20:10:00  2024-06-26  ...        39 2024-07-02 11:00:43.724534
331 2024-06-29 20:15:00  2024-06-29  ...        48 2024-07-02 11:00:43.724534
300 2024-06-29 15:17:00  2024-06-29  ...        88 2024-07-02 11:00:43.724534
254 2024-06-29 16:15:00  2024-06-29  ...        56 2024-07-02 11:00:43.724534
266 2024-06-29 14:42:00  2024-06-29  ...        88 2024-07-02 11:00:43.724534

[10 rows x 27 columns]
2024-07-02T11:00:51Z | INFO - No data to store in errors.staging_transformed_performance_data_rejected
2024-07-02T11:00:51Z | INFO - Truncating staging.transformed_performance_data
2024-07-02T11:00:51Z | INFO - Truncating staging.transformed_race_data
2024-07-02T11:00:51Z | INFO - Executing query: TRUNCATE TABLE staging.transformed_performance_data
2024-07-02T11:00:51Z | INFO - Executing query: TRUNCATE TABLE staging.transformed_race_data
2024-07-02T11:00:51Z | INFO - Query executed. Number of rows affected: -1
2024-07-02T11:00:51Z | INFO - Storing 55 records in staging.transformed_race_data
2024-07-02T11:00:51Z | INFO - Query executed. Number of rows affected: -1
2024-07-02T11:00:51Z | INFO - Storing 478 records in staging.transformed_performance_data
2024-07-02T11:00:51Z | INFO - Calling stored procedure public.insert_transformed_performance_data()
2024-07-02T11:00:51Z | INFO - Calling stored procedure public.insert_transformed_race_data()
2024-07-02T11:00:51Z | INFO - Calling stored procedure public.insert_todays_transformed_performance_data()
2024-07-02T11:00:51Z | INFO - Calling stored procedure public.insert_todays_transformed_race_data()
2024-07-02T11:00:51Z | INFO - Stored procedure public.insert_todays_transformed_race_data() completed
2024-07-02T11:00:51Z | INFO - Stored procedure public.insert_transformed_race_data() completed
2024-07-02T11:00:51Z | INFO - Stored procedure public.insert_todays_transformed_performance_data() completed
2024-07-02T11:00:52Z | INFO - Stored procedure public.insert_transformed_performance_data() completed
2024-07-02T11:00:52Z | INFO - Running post-transform checks
2024-07-02T11:00:52Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM staging.todays_joined_performance_data;
2024-07-02T11:00:52Z | INFO - Fetching data with query: SELECT DISTINCT unique_id FROM public.todays_performance_data;
2024-07-02T11:00:52Z | WARNING - MISSING DATA STAGING: 0 DATA: 788
2024-07-02T11:00:52Z | INFO - Calling stored procedure public.insert_unioned_performance_data()
2024-07-02T11:01:42Z | INFO - Stored procedure public.insert_unioned_performance_data() completed
2024-07-02T11:01:42Z | INFO - Fetching data with query: SELECT * FROM metrics.record_count_differences_vw
2024-07-02T11:01:42Z | INFO - Fetching data with query: SELECT * FROM metrics.missing_raw_data
2024-07-02T11:02:03Z | INFO - No missing data between RP and TF
2024-07-02T11:02:03Z | INFO - No missing data in final performance data table
